{"results": [{"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "full_name", "model": "{{ ref('nhl_players') }}"}}, "database": "postgres", "schema": "public", "fqn": ["data_eng_challenge", "schema_test", "not_null_nhl_players_full_name"], "unique_id": "test.data_eng_challenge.not_null_nhl_players_full_name", "package_name": "data_eng_challenge", "root_path": "/usr/app", "path": "schema_test/not_null_nhl_players_full_name.sql", "original_file_path": "models/base/nhl/nhl_players.yml", "name": "not_null_nhl_players_full_name", "resource_type": "test", "alias": "not_null_nhl_players_full_name", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["nhl_players"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.data_eng_challenge.nhl_players"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/data_eng_challenge/models/base/nhl/nhl_players.yml/schema_test/not_null_nhl_players_full_name.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom \"postgres\".\"public\".\"nhl_players\"\nwhere full_name is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom \"postgres\".\"public\".\"nhl_players\"\nwhere full_name is null\n\n", "column_name": "full_name"}, "error": null, "status": 0.0, "execution_time": 0.09647250175476074, "thread_id": "Thread-3", "timing": [{"name": "compile", "started_at": "2022-02-07T07:59:38.687645Z", "completed_at": "2022-02-07T07:59:38.696298Z"}, {"name": "execute", "started_at": "2022-02-07T07:59:38.726194Z", "completed_at": "2022-02-07T07:59:38.736083Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_greater_than_zero(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "greater_than_zero", "kwargs": {"column_name": "points", "model": "{{ ref('points_leaders') }}"}}, "database": "postgres", "schema": "public", "fqn": ["data_eng_challenge", "schema_test", "greater_than_zero_points_leaders_points"], "unique_id": "test.data_eng_challenge.greater_than_zero_points_leaders_points", "package_name": "data_eng_challenge", "root_path": "/usr/app", "path": "schema_test/greater_than_zero_points_leaders_points.sql", "original_file_path": "models/mart/nhl/points_leaders.yml", "name": "greater_than_zero_points_leaders_points", "resource_type": "test", "alias": "greater_than_zero_points_leaders_points", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["points_leaders"]], "sources": [], "depends_on": {"macros": ["macro.data_eng_challenge.test_greater_than_zero"], "nodes": ["model.data_eng_challenge.points_leaders"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/data_eng_challenge/models/mart/nhl/points_leaders.yml/schema_test/greater_than_zero_points_leaders_points.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*)\nfrom (\n    select\n      points    \n\n    from \"postgres\".\"public\".\"points_leaders\"\n\n    where points <= 0\n\n) validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*)\nfrom (\n    select\n      points    \n\n    from \"postgres\".\"public\".\"points_leaders\"\n\n    where points <= 0\n\n) validation_errors\n\n", "column_name": "points"}, "error": null, "status": 0.0, "execution_time": 0.16539406776428223, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2022-02-07T07:59:38.645104Z", "completed_at": "2022-02-07T07:59:38.725443Z"}, {"name": "execute", "started_at": "2022-02-07T07:59:38.734660Z", "completed_at": "2022-02-07T07:59:38.799806Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "assists", "model": "{{ ref('nhl_players') }}"}}, "database": "postgres", "schema": "public", "fqn": ["data_eng_challenge", "schema_test", "not_null_nhl_players_assists"], "unique_id": "test.data_eng_challenge.not_null_nhl_players_assists", "package_name": "data_eng_challenge", "root_path": "/usr/app", "path": "schema_test/not_null_nhl_players_assists.sql", "original_file_path": "models/base/nhl/nhl_players.yml", "name": "not_null_nhl_players_assists", "resource_type": "test", "alias": "not_null_nhl_players_assists", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["nhl_players"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.data_eng_challenge.nhl_players"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/data_eng_challenge/models/base/nhl/nhl_players.yml/schema_test/not_null_nhl_players_assists.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom \"postgres\".\"public\".\"nhl_players\"\nwhere assists is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom \"postgres\".\"public\".\"nhl_players\"\nwhere assists is null\n\n", "column_name": "assists"}, "error": null, "status": 0.0, "execution_time": 0.19988465309143066, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2022-02-07T07:59:38.706499Z", "completed_at": "2022-02-07T07:59:38.738470Z"}, {"name": "execute", "started_at": "2022-02-07T07:59:38.739968Z", "completed_at": "2022-02-07T07:59:38.837242Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "goals", "model": "{{ ref('nhl_players') }}"}}, "database": "postgres", "schema": "public", "fqn": ["data_eng_challenge", "schema_test", "not_null_nhl_players_goals"], "unique_id": "test.data_eng_challenge.not_null_nhl_players_goals", "package_name": "data_eng_challenge", "root_path": "/usr/app", "path": "schema_test/not_null_nhl_players_goals.sql", "original_file_path": "models/base/nhl/nhl_players.yml", "name": "not_null_nhl_players_goals", "resource_type": "test", "alias": "not_null_nhl_players_goals", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["nhl_players"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.data_eng_challenge.nhl_players"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/data_eng_challenge/models/base/nhl/nhl_players.yml/schema_test/not_null_nhl_players_goals.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom \"postgres\".\"public\".\"nhl_players\"\nwhere goals is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom \"postgres\".\"public\".\"nhl_players\"\nwhere goals is null\n\n", "column_name": "goals"}, "error": null, "status": 0.0, "execution_time": 0.16509318351745605, "thread_id": "Thread-3", "timing": [{"name": "compile", "started_at": "2022-02-07T07:59:38.750043Z", "completed_at": "2022-02-07T07:59:38.839114Z"}, {"name": "execute", "started_at": "2022-02-07T07:59:38.841755Z", "completed_at": "2022-02-07T07:59:38.894208Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "points", "model": "{{ ref('nhl_players') }}"}}, "database": "postgres", "schema": "public", "fqn": ["data_eng_challenge", "schema_test", "not_null_nhl_players_points"], "unique_id": "test.data_eng_challenge.not_null_nhl_players_points", "package_name": "data_eng_challenge", "root_path": "/usr/app", "path": "schema_test/not_null_nhl_players_points.sql", "original_file_path": "models/base/nhl/nhl_players.yml", "name": "not_null_nhl_players_points", "resource_type": "test", "alias": "not_null_nhl_players_points", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["nhl_players"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.data_eng_challenge.nhl_players"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/data_eng_challenge/models/base/nhl/nhl_players.yml/schema_test/not_null_nhl_players_points.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom \"postgres\".\"public\".\"nhl_players\"\nwhere points is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom \"postgres\".\"public\".\"nhl_players\"\nwhere points is null\n\n", "column_name": "points"}, "error": null, "status": 0.0, "execution_time": 0.09825301170349121, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2022-02-07T07:59:38.867186Z", "completed_at": "2022-02-07T07:59:38.875956Z"}, {"name": "execute", "started_at": "2022-02-07T07:59:38.876219Z", "completed_at": "2022-02-07T07:59:38.961659Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "id", "model": "{{ ref('nhl_players') }}"}}, "database": "postgres", "schema": "public", "fqn": ["data_eng_challenge", "schema_test", "not_null_nhl_players_id"], "unique_id": "test.data_eng_challenge.not_null_nhl_players_id", "package_name": "data_eng_challenge", "root_path": "/usr/app", "path": "schema_test/not_null_nhl_players_id.sql", "original_file_path": "models/base/nhl/nhl_players.yml", "name": "not_null_nhl_players_id", "resource_type": "test", "alias": "not_null_nhl_players_id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["nhl_players"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.data_eng_challenge.nhl_players"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/data_eng_challenge/models/base/nhl/nhl_players.yml/schema_test/not_null_nhl_players_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom \"postgres\".\"public\".\"nhl_players\"\nwhere id is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom \"postgres\".\"public\".\"nhl_players\"\nwhere id is null\n\n", "column_name": "id"}, "error": null, "status": 0.0, "execution_time": 0.17415165901184082, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2022-02-07T07:59:38.813084Z", "completed_at": "2022-02-07T07:59:38.938291Z"}, {"name": "execute", "started_at": "2022-02-07T07:59:38.941029Z", "completed_at": "2022-02-07T07:59:38.980949Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "id", "model": "{{ ref('nhl_players') }}"}}, "database": "postgres", "schema": "public", "fqn": ["data_eng_challenge", "schema_test", "unique_nhl_players_id"], "unique_id": "test.data_eng_challenge.unique_nhl_players_id", "package_name": "data_eng_challenge", "root_path": "/usr/app", "path": "schema_test/unique_nhl_players_id.sql", "original_file_path": "models/base/nhl/nhl_players.yml", "name": "unique_nhl_players_id", "resource_type": "test", "alias": "unique_nhl_players_id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["nhl_players"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.data_eng_challenge.nhl_players"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/data_eng_challenge/models/base/nhl/nhl_players.yml/schema_test/unique_nhl_players_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        id\n\n    from \"postgres\".\"public\".\"nhl_players\"\n    where id is not null\n    group by id\n    having count(*) > 1\n\n) validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        id\n\n    from \"postgres\".\"public\".\"nhl_players\"\n    where id is not null\n    group by id\n    having count(*) > 1\n\n) validation_errors\n\n", "column_name": "id"}, "error": null, "status": 0.0, "execution_time": 0.08842658996582031, "thread_id": "Thread-3", "timing": [{"name": "compile", "started_at": "2022-02-07T07:59:38.915983Z", "completed_at": "2022-02-07T07:59:38.970679Z"}, {"name": "execute", "started_at": "2022-02-07T07:59:38.973157Z", "completed_at": "2022-02-07T07:59:39.003157Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2022-02-07T07:59:39.012279Z", "elapsed_time": 0.5572986602783203}