2022-02-07 06:23:15.869039 (MainThread): Running with dbt=0.17.2
2022-02-07 06:23:16.054357 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-07 06:23:16.055898 (MainThread): Tracking: tracking
2022-02-07 06:23:16.057393 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99cf082a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99cf04c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99cf04c430>]}
2022-02-07 06:23:16.113772 (MainThread): Partial parsing not enabled
2022-02-07 06:23:16.118348 (MainThread): Parsing macros/core.sql
2022-02-07 06:23:16.125883 (MainThread): Parsing macros/adapters/common.sql
2022-02-07 06:23:16.188210 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-07 06:23:16.190434 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-07 06:23:16.191418 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-07 06:23:16.192490 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-07 06:23:16.194412 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-07 06:23:16.196170 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-07 06:23:16.197747 (MainThread): Parsing macros/etc/query.sql
2022-02-07 06:23:16.199538 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-07 06:23:16.201529 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-07 06:23:16.202437 (MainThread): Parsing macros/etc/datetime.sql
2022-02-07 06:23:16.211952 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-07 06:23:16.220493 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-07 06:23:16.234585 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-07 06:23:16.261238 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-07 06:23:16.267984 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-07 06:23:16.270006 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-07 06:23:16.276784 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-07 06:23:16.281412 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-07 06:23:16.289050 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-07 06:23:16.319015 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-07 06:23:16.337490 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-07 06:23:16.339450 (MainThread): Parsing macros/adapters.sql
2022-02-07 06:23:16.360340 (MainThread): Parsing macros/catalog.sql
2022-02-07 06:23:16.362541 (MainThread): Parsing macros/relations.sql
2022-02-07 06:23:16.364524 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-07 06:23:16.385332 (MainThread): Partial parsing not enabled
2022-02-07 06:23:16.388635 (MainThread): Parsing macros/greater_than_zero.sql
2022-02-07 06:23:16.426852 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 06:23:16.427069 (MainThread): Opening a new connection, currently in state init
2022-02-07 06:23:16.456293 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 06:23:16.456481 (MainThread): Opening a new connection, currently in state init
2022-02-07 06:23:16.470609 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 06:23:16.470770 (MainThread): Opening a new connection, currently in state init
2022-02-07 06:23:16.912331 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 135 macros, 0 operations, 0 seed files, 1 source
2022-02-07 06:23:16.917352 (MainThread): 
2022-02-07 06:23:16.920300 (MainThread): Acquiring new postgres connection "master".
2022-02-07 06:23:16.920438 (MainThread): Opening a new connection, currently in state init
2022-02-07 06:23:16.927618 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-02-07 06:23:16.927843 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-07 06:23:16.959273 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-02-07 06:23:16.959463 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-02-07 06:23:17.091851 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.13 seconds
2022-02-07 06:23:17.094462 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-02-07 06:23:17.113413 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-07 06:23:17.113658 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-02-07 06:23:17.119726 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 06:23:17.119865 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-07 06:23:17.123535 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2022-02-07 06:23:17.123678 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 06:23:17.125136 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-07 06:23:17.137654 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.01 seconds
2022-02-07 06:23:17.139553 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-07 06:23:17.139865 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-07 06:23:17.159973 (MainThread): Using postgres connection "master".
2022-02-07 06:23:17.161462 (MainThread): On master: BEGIN
2022-02-07 06:23:17.164869 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-02-07 06:23:17.165007 (MainThread): Using postgres connection "master".
2022-02-07 06:23:17.165097 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-07 06:23:17.189700 (MainThread): SQL status: SELECT 0 in 0.02 seconds
2022-02-07 06:23:17.190216 (MainThread): On master: ROLLBACK
2022-02-07 06:23:17.190497 (MainThread): Using postgres connection "master".
2022-02-07 06:23:17.190601 (MainThread): On master: BEGIN
2022-02-07 06:23:17.195769 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 06:23:17.195929 (MainThread): On master: COMMIT
2022-02-07 06:23:17.196033 (MainThread): Using postgres connection "master".
2022-02-07 06:23:17.196117 (MainThread): On master: COMMIT
2022-02-07 06:23:17.196325 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 06:23:17.196458 (MainThread): On master: Close
2022-02-07 06:23:17.196895 (MainThread): 06:23:17 | Concurrency: 3 threads (target='challenge')
2022-02-07 06:23:17.197211 (MainThread): 06:23:17 | 
2022-02-07 06:23:17.291829 (Thread-1): Began running node model.data_eng_challenge.player_game_stats
2022-02-07 06:23:17.293223 (Thread-1): 06:23:17 | 1 of 3 START view model public.player_game_stats..................... [RUN]
2022-02-07 06:23:17.296436 (Thread-1): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 06:23:17.296537 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 06:23:17.296632 (Thread-1): Compiling model.data_eng_challenge.player_game_stats
2022-02-07 06:23:17.324591 (Thread-1): Writing injected SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 06:23:17.334654 (Thread-1): finished collecting timing info
2022-02-07 06:23:17.390022 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 06:23:17.403713 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_tmp" cascade
2022-02-07 06:23:17.412400 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 06:23:17.414723 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 06:23:17.414823 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 06:23:17.415486 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 06:23:17.420133 (Thread-1): Writing runtime SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 06:23:17.420574 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 06:23:17.420659 (Thread-1): On model.data_eng_challenge.player_game_stats: BEGIN
2022-02-07 06:23:17.427817 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-02-07 06:23:17.427988 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 06:23:17.428061 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */

  create view "postgres"."public"."player_game_stats__dbt_tmp" as (
    select
        player_person_id as nhl_player_id,
        side,
        player_person_fullName full_name,
        player_person_currentTeam_name game_team_name,
        player_stats_skaterStats_assists stats_assists,
        player_stats_skaterStats_goals stats_goals
  from "postgres"."public"."game_stats"
  );

2022-02-07 06:23:17.929687 (Thread-1): SQL status: CREATE VIEW in 0.50 seconds
2022-02-07 06:23:17.935781 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 06:23:17.935918 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats__dbt_tmp" rename to "player_game_stats"
2022-02-07 06:23:17.937727 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 06:23:17.944824 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 06:23:17.944970 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 06:23:17.945097 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 06:23:17.949001 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-02-07 06:23:17.952847 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 06:23:17.953020 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 06:23:17.954784 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 06:23:17.957709 (Thread-1): finished collecting timing info
2022-02-07 06:23:17.958089 (Thread-1): On model.data_eng_challenge.player_game_stats: Close
2022-02-07 06:23:17.965700 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11171201-e5e9-4375-b5e0-cdb5aaf34a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99cc7b1bb0>]}
2022-02-07 06:23:17.966981 (Thread-1): 06:23:17 | 1 of 3 OK created view model public.player_game_stats................ [CREATE VIEW in 0.67s]
2022-02-07 06:23:17.971425 (Thread-1): Finished running node model.data_eng_challenge.player_game_stats
2022-02-07 06:23:17.971951 (Thread-3): Began running node model.data_eng_challenge.nhl_players
2022-02-07 06:23:17.972867 (Thread-3): 06:23:17 | 2 of 3 START view model public.nhl_players........................... [RUN]
2022-02-07 06:23:17.973368 (Thread-3): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 06:23:17.973453 (Thread-3): Opening a new connection, currently in state init
2022-02-07 06:23:17.973530 (Thread-3): Compiling model.data_eng_challenge.nhl_players
2022-02-07 06:23:17.996227 (Thread-3): Writing injected SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 06:23:17.998952 (Thread-3): finished collecting timing info
2022-02-07 06:23:18.017590 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 06:23:18.017756 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_tmp" cascade
2022-02-07 06:23:18.029877 (Thread-3): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 06:23:18.032045 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 06:23:18.032148 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_backup" cascade
2022-02-07 06:23:18.032619 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 06:23:18.034699 (Thread-3): Writing runtime SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 06:23:18.034947 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 06:23:18.035043 (Thread-3): On model.data_eng_challenge.nhl_players: BEGIN
2022-02-07 06:23:18.035467 (Thread-3): SQL status: BEGIN in 0.00 seconds
2022-02-07 06:23:18.035553 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 06:23:18.035616 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */

  create view "postgres"."public"."nhl_players__dbt_tmp" as (
    select
  * -- TODO replace this with correct columns
from "postgres"."public"."player_game_stats" --or whatever other table reference
  );

2022-02-07 06:23:18.040526 (Thread-3): SQL status: CREATE VIEW in 0.00 seconds
2022-02-07 06:23:18.042866 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 06:23:18.042959 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
alter table "postgres"."public"."nhl_players__dbt_tmp" rename to "nhl_players"
2022-02-07 06:23:18.047099 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 06:23:18.048653 (Thread-3): On model.data_eng_challenge.nhl_players: COMMIT
2022-02-07 06:23:18.048748 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 06:23:18.048814 (Thread-3): On model.data_eng_challenge.nhl_players: COMMIT
2022-02-07 06:23:18.074219 (Thread-3): SQL status: COMMIT in 0.03 seconds
2022-02-07 06:23:18.077911 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 06:23:18.078218 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_backup" cascade
2022-02-07 06:23:18.081714 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 06:23:18.084350 (Thread-3): finished collecting timing info
2022-02-07 06:23:18.084579 (Thread-3): On model.data_eng_challenge.nhl_players: Close
2022-02-07 06:23:18.091426 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11171201-e5e9-4375-b5e0-cdb5aaf34a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99cbced5b0>]}
2022-02-07 06:23:18.092735 (Thread-3): 06:23:18 | 2 of 3 OK created view model public.nhl_players...................... [CREATE VIEW in 0.12s]
2022-02-07 06:23:18.095179 (Thread-3): Finished running node model.data_eng_challenge.nhl_players
2022-02-07 06:23:18.095791 (Thread-2): Began running node model.data_eng_challenge.points_leaders
2022-02-07 06:23:18.099626 (Thread-2): 06:23:18 | 3 of 3 START view model public.points_leaders........................ [RUN]
2022-02-07 06:23:18.100095 (Thread-2): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 06:23:18.100180 (Thread-2): Opening a new connection, currently in state init
2022-02-07 06:23:18.100260 (Thread-2): Compiling model.data_eng_challenge.points_leaders
2022-02-07 06:23:18.119182 (Thread-2): Writing injected SQL for node "model.data_eng_challenge.points_leaders"
2022-02-07 06:23:18.119550 (Thread-2): finished collecting timing info
2022-02-07 06:23:18.125385 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 06:23:18.125479 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_tmp" cascade
2022-02-07 06:23:18.135680 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 06:23:18.138919 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 06:23:18.139071 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_backup" cascade
2022-02-07 06:23:18.140308 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 06:23:18.141449 (Thread-2): Writing runtime SQL for node "model.data_eng_challenge.points_leaders"
2022-02-07 06:23:18.141811 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 06:23:18.141920 (Thread-2): On model.data_eng_challenge.points_leaders: BEGIN
2022-02-07 06:23:18.143104 (Thread-2): SQL status: BEGIN in 0.00 seconds
2022-02-07 06:23:18.143233 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 06:23:18.143328 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */

  create view "postgres"."public"."points_leaders__dbt_tmp" as (
    select 
* -- TODO replace with correct projection columns
from "postgres"."public"."nhl_players"  -- or other tables
  );

2022-02-07 06:23:18.145391 (Thread-2): SQL status: CREATE VIEW in 0.00 seconds
2022-02-07 06:23:18.147535 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 06:23:18.147657 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
alter table "postgres"."public"."points_leaders__dbt_tmp" rename to "points_leaders"
2022-02-07 06:23:18.153023 (Thread-2): SQL status: ALTER TABLE in 0.01 seconds
2022-02-07 06:23:18.154204 (Thread-2): On model.data_eng_challenge.points_leaders: COMMIT
2022-02-07 06:23:18.154296 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 06:23:18.154362 (Thread-2): On model.data_eng_challenge.points_leaders: COMMIT
2022-02-07 06:23:18.182521 (Thread-2): SQL status: COMMIT in 0.03 seconds
2022-02-07 06:23:18.184777 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 06:23:18.184910 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_backup" cascade
2022-02-07 06:23:18.185743 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 06:23:18.187980 (Thread-2): finished collecting timing info
2022-02-07 06:23:18.188194 (Thread-2): On model.data_eng_challenge.points_leaders: Close
2022-02-07 06:23:18.198828 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11171201-e5e9-4375-b5e0-cdb5aaf34a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99cbcfa9a0>]}
2022-02-07 06:23:18.199986 (Thread-2): 06:23:18 | 3 of 3 OK created view model public.points_leaders................... [CREATE VIEW in 0.10s]
2022-02-07 06:23:18.200336 (Thread-2): Finished running node model.data_eng_challenge.points_leaders
2022-02-07 06:23:18.201371 (MainThread): Acquiring new postgres connection "master".
2022-02-07 06:23:18.201472 (MainThread): Opening a new connection, currently in state closed
2022-02-07 06:23:18.201569 (MainThread): Using postgres connection "master".
2022-02-07 06:23:18.201635 (MainThread): On master: BEGIN
2022-02-07 06:23:18.209157 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 06:23:18.209322 (MainThread): On master: COMMIT
2022-02-07 06:23:18.209395 (MainThread): Using postgres connection "master".
2022-02-07 06:23:18.209460 (MainThread): On master: COMMIT
2022-02-07 06:23:18.209637 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 06:23:18.209736 (MainThread): On master: Close
2022-02-07 06:23:18.212751 (MainThread): 06:23:18 | 
2022-02-07 06:23:18.213027 (MainThread): 06:23:18 | Finished running 3 view models in 1.29s.
2022-02-07 06:23:18.214881 (MainThread): Connection 'master' was properly closed.
2022-02-07 06:23:18.214968 (MainThread): Connection 'model.data_eng_challenge.player_game_stats' was properly closed.
2022-02-07 06:23:18.215032 (MainThread): Connection 'model.data_eng_challenge.nhl_players' was properly closed.
2022-02-07 06:23:18.215090 (MainThread): Connection 'model.data_eng_challenge.points_leaders' was properly closed.
2022-02-07 06:23:18.234382 (MainThread): 
2022-02-07 06:23:18.234716 (MainThread): Completed successfully
2022-02-07 06:23:18.234903 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-02-07 06:23:18.236308 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99cbd4a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99cbd4af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99cbd4ad00>]}
2022-02-07 06:23:18.236511 (MainThread): Flushing usage events
2022-02-07 07:27:37.232610 (MainThread): Running with dbt=0.17.2
2022-02-07 07:27:37.491034 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-07 07:27:37.497531 (MainThread): Tracking: tracking
2022-02-07 07:27:37.498615 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f564e6579a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f564e69e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f564e69e3a0>]}
2022-02-07 07:27:37.563041 (MainThread): Partial parsing not enabled
2022-02-07 07:27:37.588519 (MainThread): Parsing macros/core.sql
2022-02-07 07:27:37.598108 (MainThread): Parsing macros/adapters/common.sql
2022-02-07 07:27:37.656215 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-07 07:27:37.658525 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-07 07:27:37.660476 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-07 07:27:37.662579 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-07 07:27:37.665346 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-07 07:27:37.667696 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-07 07:27:37.670311 (MainThread): Parsing macros/etc/query.sql
2022-02-07 07:27:37.672986 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-07 07:27:37.676503 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-07 07:27:37.678975 (MainThread): Parsing macros/etc/datetime.sql
2022-02-07 07:27:37.689557 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-07 07:27:37.699138 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-07 07:27:37.714653 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-07 07:27:37.737572 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-07 07:27:37.745679 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-07 07:27:37.748952 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-07 07:27:37.757512 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-07 07:27:37.764490 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-07 07:27:37.774768 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-07 07:27:37.807072 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-07 07:27:37.826612 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-07 07:27:37.835246 (MainThread): Parsing macros/adapters.sql
2022-02-07 07:27:37.858617 (MainThread): Parsing macros/catalog.sql
2022-02-07 07:27:37.861795 (MainThread): Parsing macros/relations.sql
2022-02-07 07:27:37.863942 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-07 07:27:37.887474 (MainThread): Partial parsing not enabled
2022-02-07 07:27:37.887898 (MainThread): Parsing macros/greater_than_zero.sql
2022-02-07 07:27:37.922900 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:27:37.923108 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:27:37.954286 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:27:37.954494 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:27:37.966684 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:27:37.966826 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:27:38.304796 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 135 macros, 0 operations, 0 seed files, 1 source
2022-02-07 07:27:38.306858 (MainThread): 
2022-02-07 07:27:38.315148 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:27:38.315332 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:27:38.319120 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-02-07 07:27:38.319274 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-07 07:27:38.339700 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-02-07 07:27:38.346282 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-02-07 07:27:38.463485 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.12 seconds
2022-02-07 07:27:38.467088 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-02-07 07:27:38.482895 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-07 07:27:38.483154 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-02-07 07:27:38.489099 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:27:38.489231 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-07 07:27:38.493441 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:27:38.493642 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:27:38.493741 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-07 07:27:38.502666 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.01 seconds
2022-02-07 07:27:38.508015 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-07 07:27:38.508353 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-07 07:27:38.533000 (MainThread): Using postgres connection "master".
2022-02-07 07:27:38.533435 (MainThread): On master: BEGIN
2022-02-07 07:27:38.539387 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:27:38.539609 (MainThread): Using postgres connection "master".
2022-02-07 07:27:38.539716 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-07 07:27:38.580700 (MainThread): SQL status: SELECT 3 in 0.04 seconds
2022-02-07 07:27:38.584433 (MainThread): On master: ROLLBACK
2022-02-07 07:27:38.584739 (MainThread): Using postgres connection "master".
2022-02-07 07:27:38.584840 (MainThread): On master: BEGIN
2022-02-07 07:27:38.585278 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:27:38.585405 (MainThread): On master: COMMIT
2022-02-07 07:27:38.585497 (MainThread): Using postgres connection "master".
2022-02-07 07:27:38.585576 (MainThread): On master: COMMIT
2022-02-07 07:27:38.585752 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:27:38.585864 (MainThread): On master: Close
2022-02-07 07:27:38.589216 (MainThread): 07:27:38 | Concurrency: 3 threads (target='challenge')
2022-02-07 07:27:38.590604 (MainThread): 07:27:38 | 
2022-02-07 07:27:38.677782 (Thread-1): Began running node model.data_eng_challenge.player_game_stats
2022-02-07 07:27:38.679018 (Thread-1): 07:27:38 | 1 of 3 START view model public.player_game_stats..................... [RUN]
2022-02-07 07:27:38.684817 (Thread-1): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:27:38.684972 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:27:38.685074 (Thread-1): Compiling model.data_eng_challenge.player_game_stats
2022-02-07 07:27:38.712343 (Thread-1): Writing injected SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 07:27:38.778219 (Thread-1): finished collecting timing info
2022-02-07 07:27:38.878624 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:27:38.885096 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_tmp" cascade
2022-02-07 07:27:38.898941 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 07:27:38.911694 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:27:38.911863 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 07:27:38.914668 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:27:38.928655 (Thread-1): Writing runtime SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 07:27:38.951848 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:27:38.952127 (Thread-1): On model.data_eng_challenge.player_game_stats: BEGIN
2022-02-07 07:27:38.953136 (Thread-1): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:27:38.953240 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:27:38.953308 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */

  create view "postgres"."public"."player_game_stats__dbt_tmp" as (
    select
        player_person_id as nhl_player_id,
        side,
        player_person_fullName full_name,
        player_person_currentTeam_name game_team_name,
        player_stats_skaterStats_assists stats_assists,
        player_stats_skaterStats_goals stats_goals
  from "postgres"."public"."game_stats"
  );

2022-02-07 07:27:38.960703 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-02-07 07:27:38.984737 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:27:38.990018 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats" rename to "player_game_stats__dbt_backup"
2022-02-07 07:27:38.993467 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:27:38.997110 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:27:38.997248 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats__dbt_tmp" rename to "player_game_stats"
2022-02-07 07:27:39.001224 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:27:39.017167 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 07:27:39.017329 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:27:39.017401 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 07:27:39.067457 (Thread-1): SQL status: COMMIT in 0.05 seconds
2022-02-07 07:27:39.070854 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:27:39.070954 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 07:27:39.164486 (Thread-1): SQL status: DROP VIEW in 0.09 seconds
2022-02-07 07:27:39.167306 (Thread-1): finished collecting timing info
2022-02-07 07:27:39.167593 (Thread-1): On model.data_eng_challenge.player_game_stats: Close
2022-02-07 07:27:39.169508 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5346fba-dc3d-4a10-928a-91764a1ae8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f564aaa90d0>]}
2022-02-07 07:27:39.170543 (Thread-1): 07:27:39 | 1 of 3 OK created view model public.player_game_stats................ [CREATE VIEW in 0.48s]
2022-02-07 07:27:39.171934 (Thread-1): Finished running node model.data_eng_challenge.player_game_stats
2022-02-07 07:27:39.172543 (Thread-3): Began running node model.data_eng_challenge.nhl_players
2022-02-07 07:27:39.173615 (Thread-3): 07:27:39 | 2 of 3 START view model public.nhl_players........................... [RUN]
2022-02-07 07:27:39.179569 (Thread-3): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:27:39.179717 (Thread-3): Opening a new connection, currently in state init
2022-02-07 07:27:39.179808 (Thread-3): Compiling model.data_eng_challenge.nhl_players
2022-02-07 07:27:39.212646 (Thread-3): Writing injected SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 07:27:39.217578 (Thread-3): finished collecting timing info
2022-02-07 07:27:39.224097 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:27:39.224230 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_tmp" cascade
2022-02-07 07:27:39.242438 (Thread-3): SQL status: DROP VIEW in 0.02 seconds
2022-02-07 07:27:39.244867 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:27:39.244964 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_backup" cascade
2022-02-07 07:27:39.250459 (Thread-3): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 07:27:39.251958 (Thread-3): Writing runtime SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 07:27:39.255323 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:27:39.255437 (Thread-3): On model.data_eng_challenge.nhl_players: BEGIN
2022-02-07 07:27:39.256140 (Thread-3): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:27:39.256243 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:27:39.256327 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */

  create view "postgres"."public"."nhl_players__dbt_tmp" as (
    select
  * -- TODO replace this with correct columns
from "postgres"."public"."player_game_stats" --or whatever other table reference
  );

2022-02-07 07:27:39.264309 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-02-07 07:27:39.266887 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:27:39.266983 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
alter table "postgres"."public"."nhl_players__dbt_tmp" rename to "nhl_players"
2022-02-07 07:27:39.273792 (Thread-3): SQL status: ALTER TABLE in 0.01 seconds
2022-02-07 07:27:39.275133 (Thread-3): On model.data_eng_challenge.nhl_players: COMMIT
2022-02-07 07:27:39.275279 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:27:39.275352 (Thread-3): On model.data_eng_challenge.nhl_players: COMMIT
2022-02-07 07:27:39.323474 (Thread-3): SQL status: COMMIT in 0.05 seconds
2022-02-07 07:27:39.325150 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:27:39.325247 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_backup" cascade
2022-02-07 07:27:39.326722 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:27:39.332863 (Thread-3): finished collecting timing info
2022-02-07 07:27:39.333141 (Thread-3): On model.data_eng_challenge.nhl_players: Close
2022-02-07 07:27:39.343882 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5346fba-dc3d-4a10-928a-91764a1ae8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f564bc85a30>]}
2022-02-07 07:27:39.346889 (Thread-3): 07:27:39 | 2 of 3 OK created view model public.nhl_players...................... [CREATE VIEW in 0.16s]
2022-02-07 07:27:39.349441 (Thread-3): Finished running node model.data_eng_challenge.nhl_players
2022-02-07 07:27:39.350115 (Thread-2): Began running node model.data_eng_challenge.points_leaders
2022-02-07 07:27:39.351352 (Thread-2): 07:27:39 | 3 of 3 START view model public.points_leaders........................ [RUN]
2022-02-07 07:27:39.356816 (Thread-2): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:27:39.356975 (Thread-2): Opening a new connection, currently in state closed
2022-02-07 07:27:39.357073 (Thread-2): Compiling model.data_eng_challenge.points_leaders
2022-02-07 07:27:39.364778 (Thread-2): Writing injected SQL for node "model.data_eng_challenge.points_leaders"
2022-02-07 07:27:39.391361 (Thread-2): finished collecting timing info
2022-02-07 07:27:39.411389 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:27:39.411573 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_tmp" cascade
2022-02-07 07:27:39.418004 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 07:27:39.420618 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:27:39.420784 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_backup" cascade
2022-02-07 07:27:39.422599 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:27:39.424275 (Thread-2): Writing runtime SQL for node "model.data_eng_challenge.points_leaders"
2022-02-07 07:27:39.443907 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:27:39.444072 (Thread-2): On model.data_eng_challenge.points_leaders: BEGIN
2022-02-07 07:27:39.445250 (Thread-2): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:27:39.445352 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:27:39.445421 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */

  create view "postgres"."public"."points_leaders__dbt_tmp" as (
    select 
* -- TODO replace with correct projection columns
from "postgres"."public"."nhl_players"  -- or other tables
  );

2022-02-07 07:27:39.452855 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2022-02-07 07:27:39.456082 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:27:39.456206 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
alter table "postgres"."public"."points_leaders__dbt_tmp" rename to "points_leaders"
2022-02-07 07:27:39.472685 (Thread-2): SQL status: ALTER TABLE in 0.02 seconds
2022-02-07 07:27:39.474638 (Thread-2): On model.data_eng_challenge.points_leaders: COMMIT
2022-02-07 07:27:39.474743 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:27:39.474810 (Thread-2): On model.data_eng_challenge.points_leaders: COMMIT
2022-02-07 07:27:39.493314 (Thread-2): SQL status: COMMIT in 0.02 seconds
2022-02-07 07:27:39.495096 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:27:39.495200 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_backup" cascade
2022-02-07 07:27:39.496004 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:27:39.498476 (Thread-2): finished collecting timing info
2022-02-07 07:27:39.498706 (Thread-2): On model.data_eng_challenge.points_leaders: Close
2022-02-07 07:27:39.505534 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5346fba-dc3d-4a10-928a-91764a1ae8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f564bc84d60>]}
2022-02-07 07:27:39.506634 (Thread-2): 07:27:39 | 3 of 3 OK created view model public.points_leaders................... [CREATE VIEW in 0.15s]
2022-02-07 07:27:39.508863 (Thread-2): Finished running node model.data_eng_challenge.points_leaders
2022-02-07 07:27:39.510009 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:27:39.510104 (MainThread): Opening a new connection, currently in state closed
2022-02-07 07:27:39.510297 (MainThread): Using postgres connection "master".
2022-02-07 07:27:39.510373 (MainThread): On master: BEGIN
2022-02-07 07:27:39.524782 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:27:39.524982 (MainThread): On master: COMMIT
2022-02-07 07:27:39.525059 (MainThread): Using postgres connection "master".
2022-02-07 07:27:39.525151 (MainThread): On master: COMMIT
2022-02-07 07:27:39.525336 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:27:39.525454 (MainThread): On master: Close
2022-02-07 07:27:39.529093 (MainThread): 07:27:39 | 
2022-02-07 07:27:39.529384 (MainThread): 07:27:39 | Finished running 3 view models in 1.21s.
2022-02-07 07:27:39.529550 (MainThread): Connection 'master' was properly closed.
2022-02-07 07:27:39.529624 (MainThread): Connection 'model.data_eng_challenge.points_leaders' was properly closed.
2022-02-07 07:27:39.529684 (MainThread): Connection 'model.data_eng_challenge.player_game_stats' was properly closed.
2022-02-07 07:27:39.529741 (MainThread): Connection 'model.data_eng_challenge.nhl_players' was properly closed.
2022-02-07 07:27:39.566199 (MainThread): 
2022-02-07 07:27:39.566612 (MainThread): Completed successfully
2022-02-07 07:27:39.566803 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-02-07 07:27:39.567062 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f564bcca4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f564ac3f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f564ac3f6a0>]}
2022-02-07 07:27:39.567276 (MainThread): Flushing usage events
2022-02-07 07:40:53.747499 (MainThread): Running with dbt=0.17.2
2022-02-07 07:40:53.854478 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-07 07:40:53.855723 (MainThread): Tracking: tracking
2022-02-07 07:40:53.857272 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa53427be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa533f1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa533f13d0>]}
2022-02-07 07:40:53.886684 (MainThread): Partial parsing not enabled
2022-02-07 07:40:53.888316 (MainThread): Parsing macros/core.sql
2022-02-07 07:40:53.893894 (MainThread): Parsing macros/adapters/common.sql
2022-02-07 07:40:53.977761 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-07 07:40:53.979003 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-07 07:40:53.983544 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-07 07:40:53.984640 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-07 07:40:53.986514 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-07 07:40:53.990854 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-07 07:40:53.994145 (MainThread): Parsing macros/etc/query.sql
2022-02-07 07:40:53.995201 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-07 07:40:53.997218 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-07 07:40:53.998137 (MainThread): Parsing macros/etc/datetime.sql
2022-02-07 07:40:54.007451 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-07 07:40:54.015564 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-07 07:40:54.031470 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-07 07:40:54.053279 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-07 07:40:54.060873 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-07 07:40:54.062930 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-07 07:40:54.069630 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-07 07:40:54.075164 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-07 07:40:54.081413 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-07 07:40:54.110494 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-07 07:40:54.128957 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-07 07:40:54.130829 (MainThread): Parsing macros/adapters.sql
2022-02-07 07:40:54.150985 (MainThread): Parsing macros/catalog.sql
2022-02-07 07:40:54.153538 (MainThread): Parsing macros/relations.sql
2022-02-07 07:40:54.154834 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-07 07:40:54.174986 (MainThread): Partial parsing not enabled
2022-02-07 07:40:54.182818 (MainThread): Parsing macros/greater_than_zero.sql
2022-02-07 07:40:54.226451 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:40:54.226662 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:40:54.257165 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:40:54.257344 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:40:54.270917 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:40:54.271128 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:40:54.568155 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 135 macros, 0 operations, 0 seed files, 1 source
2022-02-07 07:40:54.570310 (MainThread): 
2022-02-07 07:40:54.575169 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:40:54.575305 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:40:54.584312 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-02-07 07:40:54.584472 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-07 07:40:54.593347 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-02-07 07:40:54.593435 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-02-07 07:40:54.628996 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.04 seconds
2022-02-07 07:40:54.631766 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-02-07 07:40:54.648911 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-07 07:40:54.649147 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-02-07 07:40:54.654527 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:40:54.654655 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-07 07:40:54.661687 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:40:54.661981 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:40:54.662088 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-07 07:40:54.677118 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.01 seconds
2022-02-07 07:40:54.681772 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-07 07:40:54.695330 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-07 07:40:54.756732 (MainThread): Using postgres connection "master".
2022-02-07 07:40:54.759919 (MainThread): On master: BEGIN
2022-02-07 07:40:54.765431 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:40:54.765611 (MainThread): Using postgres connection "master".
2022-02-07 07:40:54.765710 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-07 07:40:54.781362 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-02-07 07:40:54.785473 (MainThread): On master: ROLLBACK
2022-02-07 07:40:54.791192 (MainThread): Using postgres connection "master".
2022-02-07 07:40:54.791325 (MainThread): On master: BEGIN
2022-02-07 07:40:54.792081 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:40:54.792181 (MainThread): On master: COMMIT
2022-02-07 07:40:54.792251 (MainThread): Using postgres connection "master".
2022-02-07 07:40:54.792334 (MainThread): On master: COMMIT
2022-02-07 07:40:54.792510 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:40:54.792647 (MainThread): On master: Close
2022-02-07 07:40:54.796391 (MainThread): 07:40:54 | Concurrency: 3 threads (target='challenge')
2022-02-07 07:40:54.796695 (MainThread): 07:40:54 | 
2022-02-07 07:40:54.840931 (Thread-1): Began running node model.data_eng_challenge.player_game_stats
2022-02-07 07:40:54.847203 (Thread-1): 07:40:54 | 1 of 3 START view model public.player_game_stats..................... [RUN]
2022-02-07 07:40:54.847785 (Thread-1): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:40:54.847873 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:40:54.847965 (Thread-1): Compiling model.data_eng_challenge.player_game_stats
2022-02-07 07:40:54.877605 (Thread-1): Writing injected SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 07:40:54.878132 (Thread-1): finished collecting timing info
2022-02-07 07:40:54.921938 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:40:54.922140 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_tmp" cascade
2022-02-07 07:40:54.926495 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:40:54.928697 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:40:54.928820 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 07:40:54.930035 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:40:54.934327 (Thread-1): Writing runtime SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 07:40:54.950766 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:40:54.950973 (Thread-1): On model.data_eng_challenge.player_game_stats: BEGIN
2022-02-07 07:40:54.951881 (Thread-1): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:40:54.951985 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:40:54.952053 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */

  create view "postgres"."public"."player_game_stats__dbt_tmp" as (
    select
        player_person_id as nhl_player_id,
        side,
        player_person_fullName full_name,
        player_person_currentTeam_name game_team_name,
        player_stats_skaterStats_assists stats_assists,
        player_stats_skaterStats_goals stats_goals
  from "postgres"."public"."game_stats"
  );

2022-02-07 07:40:55.006908 (Thread-1): SQL status: CREATE VIEW in 0.05 seconds
2022-02-07 07:40:55.016890 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:40:55.017024 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats" rename to "player_game_stats__dbt_backup"
2022-02-07 07:40:55.024712 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2022-02-07 07:40:55.026961 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:40:55.027222 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats__dbt_tmp" rename to "player_game_stats"
2022-02-07 07:40:55.031194 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:40:55.037658 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 07:40:55.037801 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:40:55.037870 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 07:40:55.064214 (Thread-1): SQL status: COMMIT in 0.03 seconds
2022-02-07 07:40:55.068226 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:40:55.068373 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 07:40:55.135640 (Thread-1): SQL status: DROP VIEW in 0.07 seconds
2022-02-07 07:40:55.138307 (Thread-1): finished collecting timing info
2022-02-07 07:40:55.138592 (Thread-1): On model.data_eng_challenge.player_game_stats: Close
2022-02-07 07:40:55.140787 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '089e86c4-4847-42f4-9bf0-4283e5dcd894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa50075f70>]}
2022-02-07 07:40:55.141868 (Thread-1): 07:40:55 | 1 of 3 OK created view model public.player_game_stats................ [CREATE VIEW in 0.29s]
2022-02-07 07:40:55.144678 (Thread-1): Finished running node model.data_eng_challenge.player_game_stats
2022-02-07 07:40:55.145292 (Thread-3): Began running node model.data_eng_challenge.nhl_players
2022-02-07 07:40:55.146407 (Thread-3): 07:40:55 | 2 of 3 START view model public.nhl_players........................... [RUN]
2022-02-07 07:40:55.151415 (Thread-3): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:40:55.151552 (Thread-3): Opening a new connection, currently in state init
2022-02-07 07:40:55.151644 (Thread-3): Compiling model.data_eng_challenge.nhl_players
2022-02-07 07:40:55.186465 (Thread-3): Writing injected SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 07:40:55.187291 (Thread-3): finished collecting timing info
2022-02-07 07:40:55.206815 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:40:55.207096 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_tmp" cascade
2022-02-07 07:40:55.211655 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:40:55.213993 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:40:55.214127 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_backup" cascade
2022-02-07 07:40:55.215559 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:40:55.216801 (Thread-3): Writing runtime SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 07:40:55.218178 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:40:55.218302 (Thread-3): On model.data_eng_challenge.nhl_players: BEGIN
2022-02-07 07:40:55.220097 (Thread-3): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:40:55.220232 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:40:55.220328 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */

  create view "postgres"."public"."nhl_players__dbt_tmp" as (
    select
  nhl_player_id as id,
  full_name,
  game_team_name as team_name,
  stats_assists as assists,
  stats_goals as goals,
  (stats_assists + stats_goals) as points -- TODO replace this with correct columns
from "postgres"."public"."player_game_stats" --or whatever other table reference
  );

2022-02-07 07:40:55.258319 (Thread-3): SQL status: CREATE VIEW in 0.04 seconds
2022-02-07 07:40:55.261227 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:40:55.261328 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
alter table "postgres"."public"."nhl_players__dbt_tmp" rename to "nhl_players"
2022-02-07 07:40:55.262659 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:40:55.263654 (Thread-3): On model.data_eng_challenge.nhl_players: COMMIT
2022-02-07 07:40:55.263744 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:40:55.263811 (Thread-3): On model.data_eng_challenge.nhl_players: COMMIT
2022-02-07 07:40:55.271366 (Thread-3): SQL status: COMMIT in 0.01 seconds
2022-02-07 07:40:55.272974 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:40:55.273066 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_backup" cascade
2022-02-07 07:40:55.273814 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:40:55.276060 (Thread-3): finished collecting timing info
2022-02-07 07:40:55.276298 (Thread-3): On model.data_eng_challenge.nhl_players: Close
2022-02-07 07:40:55.282078 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '089e86c4-4847-42f4-9bf0-4283e5dcd894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa502250a0>]}
2022-02-07 07:40:55.283192 (Thread-3): 07:40:55 | 2 of 3 OK created view model public.nhl_players...................... [CREATE VIEW in 0.13s]
2022-02-07 07:40:55.286434 (Thread-3): Finished running node model.data_eng_challenge.nhl_players
2022-02-07 07:40:55.287023 (Thread-2): Began running node model.data_eng_challenge.points_leaders
2022-02-07 07:40:55.288356 (Thread-2): 07:40:55 | 3 of 3 START view model public.points_leaders........................ [RUN]
2022-02-07 07:40:55.294296 (Thread-2): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:40:55.294434 (Thread-2): Opening a new connection, currently in state init
2022-02-07 07:40:55.294521 (Thread-2): Compiling model.data_eng_challenge.points_leaders
2022-02-07 07:40:55.302334 (Thread-2): Writing injected SQL for node "model.data_eng_challenge.points_leaders"
2022-02-07 07:40:55.310542 (Thread-2): finished collecting timing info
2022-02-07 07:40:55.316788 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:40:55.316900 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_tmp" cascade
2022-02-07 07:40:55.331043 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 07:40:55.337739 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:40:55.337908 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_backup" cascade
2022-02-07 07:40:55.338805 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:40:55.340191 (Thread-2): Writing runtime SQL for node "model.data_eng_challenge.points_leaders"
2022-02-07 07:40:55.340690 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:40:55.340778 (Thread-2): On model.data_eng_challenge.points_leaders: BEGIN
2022-02-07 07:40:55.343340 (Thread-2): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:40:55.343440 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:40:55.343508 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */

  create view "postgres"."public"."points_leaders__dbt_tmp" as (
    select 
* -- TODO replace with correct projection columns
from "postgres"."public"."nhl_players"  -- or other tables
  );

2022-02-07 07:40:55.348016 (Thread-2): SQL status: CREATE VIEW in 0.00 seconds
2022-02-07 07:40:55.350384 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:40:55.350478 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
alter table "postgres"."public"."points_leaders__dbt_tmp" rename to "points_leaders"
2022-02-07 07:40:55.353611 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:40:55.356893 (Thread-2): On model.data_eng_challenge.points_leaders: COMMIT
2022-02-07 07:40:55.356995 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:40:55.357065 (Thread-2): On model.data_eng_challenge.points_leaders: COMMIT
2022-02-07 07:40:55.362842 (Thread-2): SQL status: COMMIT in 0.01 seconds
2022-02-07 07:40:55.364431 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:40:55.364526 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_backup" cascade
2022-02-07 07:40:55.365390 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:40:55.367807 (Thread-2): finished collecting timing info
2022-02-07 07:40:55.368039 (Thread-2): On model.data_eng_challenge.points_leaders: Close
2022-02-07 07:40:55.375546 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '089e86c4-4847-42f4-9bf0-4283e5dcd894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa50ab3eb0>]}
2022-02-07 07:40:55.376702 (Thread-2): 07:40:55 | 3 of 3 OK created view model public.points_leaders................... [CREATE VIEW in 0.08s]
2022-02-07 07:40:55.378180 (Thread-2): Finished running node model.data_eng_challenge.points_leaders
2022-02-07 07:40:55.379331 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:40:55.379427 (MainThread): Opening a new connection, currently in state closed
2022-02-07 07:40:55.379533 (MainThread): Using postgres connection "master".
2022-02-07 07:40:55.379599 (MainThread): On master: BEGIN
2022-02-07 07:40:55.388076 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:40:55.388260 (MainThread): On master: COMMIT
2022-02-07 07:40:55.388335 (MainThread): Using postgres connection "master".
2022-02-07 07:40:55.388400 (MainThread): On master: COMMIT
2022-02-07 07:40:55.388599 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:40:55.388710 (MainThread): On master: Close
2022-02-07 07:40:55.391776 (MainThread): 07:40:55 | 
2022-02-07 07:40:55.393380 (MainThread): 07:40:55 | Finished running 3 view models in 0.82s.
2022-02-07 07:40:55.393615 (MainThread): Connection 'master' was properly closed.
2022-02-07 07:40:55.393694 (MainThread): Connection 'model.data_eng_challenge.player_game_stats' was properly closed.
2022-02-07 07:40:55.393757 (MainThread): Connection 'model.data_eng_challenge.nhl_players' was properly closed.
2022-02-07 07:40:55.393815 (MainThread): Connection 'model.data_eng_challenge.points_leaders' was properly closed.
2022-02-07 07:40:55.412507 (MainThread): 
2022-02-07 07:40:55.425314 (MainThread): Completed successfully
2022-02-07 07:40:55.425760 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-02-07 07:40:55.426049 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa50aa9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa50203e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa500f1f70>]}
2022-02-07 07:40:55.426268 (MainThread): Flushing usage events
2022-02-07 07:42:10.634503 (MainThread): Running with dbt=0.17.2
2022-02-07 07:42:10.740026 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-02-07 07:42:10.741278 (MainThread): Tracking: tracking
2022-02-07 07:42:10.742809 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1006639d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10062d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10062d430>]}
2022-02-07 07:42:10.793950 (MainThread): Partial parsing not enabled
2022-02-07 07:42:10.796770 (MainThread): Parsing macros/core.sql
2022-02-07 07:42:10.801858 (MainThread): Parsing macros/adapters/common.sql
2022-02-07 07:42:10.871559 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-07 07:42:10.873016 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-07 07:42:10.873884 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-07 07:42:10.875041 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-07 07:42:10.878412 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-07 07:42:10.880018 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-07 07:42:10.881680 (MainThread): Parsing macros/etc/query.sql
2022-02-07 07:42:10.882781 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-07 07:42:10.884651 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-07 07:42:10.885590 (MainThread): Parsing macros/etc/datetime.sql
2022-02-07 07:42:10.895008 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-07 07:42:10.903037 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-07 07:42:10.919150 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-07 07:42:10.941085 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-07 07:42:10.947474 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-07 07:42:10.949246 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-07 07:42:10.956122 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-07 07:42:10.961300 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-07 07:42:10.967958 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-07 07:42:10.996997 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-07 07:42:11.014837 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-07 07:42:11.016815 (MainThread): Parsing macros/adapters.sql
2022-02-07 07:42:11.040667 (MainThread): Parsing macros/catalog.sql
2022-02-07 07:42:11.044436 (MainThread): Parsing macros/relations.sql
2022-02-07 07:42:11.045790 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-07 07:42:11.067048 (MainThread): Partial parsing not enabled
2022-02-07 07:42:11.067420 (MainThread): Parsing macros/greater_than_zero.sql
2022-02-07 07:42:11.101269 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:42:11.101465 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:42:11.132335 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:42:11.132593 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:42:11.145209 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:42:11.145343 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:42:11.457205 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 135 macros, 0 operations, 0 seed files, 1 source
2022-02-07 07:42:11.459182 (MainThread): 
2022-02-07 07:42:11.464199 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:42:11.464337 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:42:11.487460 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-07 07:42:11.487760 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-02-07 07:42:11.506611 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:42:11.506998 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-07 07:42:11.512079 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:42:11.512255 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:42:11.512357 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-07 07:42:11.515672 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2022-02-07 07:42:11.521226 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-07 07:42:11.528279 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-07 07:42:11.562329 (MainThread): Using postgres connection "master".
2022-02-07 07:42:11.571037 (MainThread): On master: BEGIN
2022-02-07 07:42:11.584772 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:42:11.584955 (MainThread): Using postgres connection "master".
2022-02-07 07:42:11.585032 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-07 07:42:11.597285 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2022-02-07 07:42:11.601250 (MainThread): On master: ROLLBACK
2022-02-07 07:42:11.606621 (MainThread): On master: Close
2022-02-07 07:42:11.607137 (MainThread): 07:42:11 | Concurrency: 3 threads (target='challenge')
2022-02-07 07:42:11.610844 (MainThread): 07:42:11 | 
2022-02-07 07:42:11.643588 (Thread-1): Began running node test.data_eng_challenge.greater_than_zero_points_leaders_points
2022-02-07 07:42:11.643801 (Thread-1): 07:42:11 | 1 of 7 START test greater_than_zero_points_leaders_points............ [RUN]
2022-02-07 07:42:11.645432 (Thread-2): Began running node test.data_eng_challenge.not_null_nhl_players_assists
2022-02-07 07:42:11.645625 (Thread-2): 07:42:11 | 2 of 7 START test not_null_nhl_players_assists....................... [RUN]
2022-02-07 07:42:11.645739 (Thread-3): Began running node test.data_eng_challenge.not_null_nhl_players_full_name
2022-02-07 07:42:11.645969 (Thread-3): 07:42:11 | 3 of 7 START test not_null_nhl_players_full_name..................... [RUN]
2022-02-07 07:42:11.646367 (Thread-1): Acquiring new postgres connection "test.data_eng_challenge.greater_than_zero_points_leaders_points".
2022-02-07 07:42:11.646450 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:42:11.646547 (Thread-1): Compiling test.data_eng_challenge.greater_than_zero_points_leaders_points
2022-02-07 07:42:11.675058 (Thread-2): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_assists".
2022-02-07 07:42:11.675206 (Thread-2): Opening a new connection, currently in state init
2022-02-07 07:42:11.675295 (Thread-2): Compiling test.data_eng_challenge.not_null_nhl_players_assists
2022-02-07 07:42:11.703661 (Thread-1): Writing injected SQL for node "test.data_eng_challenge.greater_than_zero_points_leaders_points"
2022-02-07 07:42:11.710945 (Thread-3): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_full_name".
2022-02-07 07:42:11.717918 (Thread-3): Opening a new connection, currently in state init
2022-02-07 07:42:11.718060 (Thread-3): Compiling test.data_eng_challenge.not_null_nhl_players_full_name
2022-02-07 07:42:11.714104 (Thread-2): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_assists"
2022-02-07 07:42:11.745740 (Thread-2): finished collecting timing info
2022-02-07 07:42:11.746132 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_assists".
2022-02-07 07:42:11.746218 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: BEGIN
2022-02-07 07:42:11.748641 (Thread-1): finished collecting timing info
2022-02-07 07:42:11.748929 (Thread-1): Using postgres connection "test.data_eng_challenge.greater_than_zero_points_leaders_points".
2022-02-07 07:42:11.749011 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: BEGIN
2022-02-07 07:42:11.757778 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:42:11.757979 (Thread-1): Using postgres connection "test.data_eng_challenge.greater_than_zero_points_leaders_points".
2022-02-07 07:42:11.758065 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.greater_than_zero_points_leaders_points"} */




select count(*)
from (
    select
      points    

    from "postgres"."public"."points_leaders"

    where points <= 0

) validation_errors


2022-02-07 07:42:11.759964 (Thread-3): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_full_name"
2022-02-07 07:42:11.760213 (Thread-3): finished collecting timing info
2022-02-07 07:42:11.760511 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_full_name".
2022-02-07 07:42:11.760588 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: BEGIN
2022-02-07 07:42:11.769358 (Thread-2): SQL status: BEGIN in 0.02 seconds
2022-02-07 07:42:11.769557 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_assists".
2022-02-07 07:42:11.769639 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_assists"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where assists is null


2022-02-07 07:42:11.779307 (Thread-3): SQL status: BEGIN in 0.02 seconds
2022-02-07 07:42:11.779485 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_full_name".
2022-02-07 07:42:11.779566 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_full_name"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where full_name is null


2022-02-07 07:42:11.794637 (Thread-2): SQL status: SELECT 1 in 0.02 seconds
2022-02-07 07:42:11.795008 (Thread-2): finished collecting timing info
2022-02-07 07:42:11.795284 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: ROLLBACK
2022-02-07 07:42:11.797660 (Thread-1): SQL status: SELECT 1 in 0.04 seconds
2022-02-07 07:42:11.797868 (Thread-1): finished collecting timing info
2022-02-07 07:42:11.798080 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: ROLLBACK
2022-02-07 07:42:11.799744 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: Close
2022-02-07 07:42:11.800160 (Thread-2): 07:42:11 | 2 of 7 PASS not_null_nhl_players_assists............................. [PASS in 0.13s]
2022-02-07 07:42:11.800497 (Thread-2): Finished running node test.data_eng_challenge.not_null_nhl_players_assists
2022-02-07 07:42:11.800635 (Thread-2): Began running node test.data_eng_challenge.not_null_nhl_players_goals
2022-02-07 07:42:11.800831 (Thread-2): 07:42:11 | 4 of 7 START test not_null_nhl_players_goals......................... [RUN]
2022-02-07 07:42:11.802187 (Thread-2): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_goals".
2022-02-07 07:42:11.802281 (Thread-2): Opening a new connection, currently in state closed
2022-02-07 07:42:11.802364 (Thread-2): Compiling test.data_eng_challenge.not_null_nhl_players_goals
2022-02-07 07:42:11.822444 (Thread-2): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_goals"
2022-02-07 07:42:11.828711 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: Close
2022-02-07 07:42:11.828848 (Thread-3): SQL status: SELECT 1 in 0.05 seconds
2022-02-07 07:42:11.833005 (Thread-3): finished collecting timing info
2022-02-07 07:42:11.833303 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: ROLLBACK
2022-02-07 07:42:11.833944 (Thread-1): 07:42:11 | 1 of 7 FAIL 305 greater_than_zero_points_leaders_points.............. [FAIL 305 in 0.19s]
2022-02-07 07:42:11.834252 (Thread-1): Finished running node test.data_eng_challenge.greater_than_zero_points_leaders_points
2022-02-07 07:42:11.834380 (Thread-1): Began running node test.data_eng_challenge.not_null_nhl_players_id
2022-02-07 07:42:11.834526 (Thread-1): 07:42:11 | 5 of 7 START test not_null_nhl_players_id............................ [RUN]
2022-02-07 07:42:11.834781 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: Close
2022-02-07 07:42:11.838286 (Thread-3): 07:42:11 | 3 of 7 PASS not_null_nhl_players_full_name........................... [PASS in 0.13s]
2022-02-07 07:42:11.838530 (Thread-1): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_id".
2022-02-07 07:42:11.838613 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:42:11.838698 (Thread-1): Compiling test.data_eng_challenge.not_null_nhl_players_id
2022-02-07 07:42:11.868650 (Thread-1): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_id"
2022-02-07 07:42:11.869250 (Thread-2): finished collecting timing info
2022-02-07 07:42:11.869708 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_goals".
2022-02-07 07:42:11.869937 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_goals: BEGIN
2022-02-07 07:42:11.869479 (Thread-3): Finished running node test.data_eng_challenge.not_null_nhl_players_full_name
2022-02-07 07:42:11.871252 (Thread-3): Began running node test.data_eng_challenge.not_null_nhl_players_points
2022-02-07 07:42:11.871387 (Thread-3): 07:42:11 | 6 of 7 START test not_null_nhl_players_points........................ [RUN]
2022-02-07 07:42:11.871916 (Thread-3): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_points".
2022-02-07 07:42:11.872005 (Thread-3): Opening a new connection, currently in state closed
2022-02-07 07:42:11.872087 (Thread-3): Compiling test.data_eng_challenge.not_null_nhl_players_points
2022-02-07 07:42:11.894847 (Thread-3): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_points"
2022-02-07 07:42:11.900541 (Thread-1): finished collecting timing info
2022-02-07 07:42:11.901660 (Thread-1): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_id".
2022-02-07 07:42:11.901745 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: BEGIN
2022-02-07 07:42:11.901404 (Thread-2): SQL status: BEGIN in 0.03 seconds
2022-02-07 07:42:11.902947 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_goals".
2022-02-07 07:42:11.903031 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_goals: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_goals"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where goals is null


2022-02-07 07:42:11.909598 (Thread-2): SQL status: SELECT 1 in 0.01 seconds
2022-02-07 07:42:11.909922 (Thread-2): finished collecting timing info
2022-02-07 07:42:11.910184 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_goals: ROLLBACK
2022-02-07 07:42:11.912900 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:42:11.913007 (Thread-1): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_id".
2022-02-07 07:42:11.913084 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_id"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where id is null


2022-02-07 07:42:11.914160 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_goals: Close
2022-02-07 07:42:11.917947 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-02-07 07:42:11.918228 (Thread-1): finished collecting timing info
2022-02-07 07:42:11.918492 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: ROLLBACK
2022-02-07 07:42:11.919016 (Thread-2): 07:42:11 | 4 of 7 PASS not_null_nhl_players_goals............................... [PASS in 0.12s]
2022-02-07 07:42:11.920881 (Thread-2): Finished running node test.data_eng_challenge.not_null_nhl_players_goals
2022-02-07 07:42:11.921031 (Thread-2): Began running node test.data_eng_challenge.unique_nhl_players_id
2022-02-07 07:42:11.921233 (Thread-2): 07:42:11 | 7 of 7 START test unique_nhl_players_id.............................. [RUN]
2022-02-07 07:42:11.921452 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: Close
2022-02-07 07:42:11.925175 (Thread-2): Acquiring new postgres connection "test.data_eng_challenge.unique_nhl_players_id".
2022-02-07 07:42:11.925304 (Thread-2): Opening a new connection, currently in state closed
2022-02-07 07:42:11.925394 (Thread-2): Compiling test.data_eng_challenge.unique_nhl_players_id
2022-02-07 07:42:11.939867 (Thread-2): Writing injected SQL for node "test.data_eng_challenge.unique_nhl_players_id"
2022-02-07 07:42:11.944058 (Thread-1): 07:42:11 | 5 of 7 PASS not_null_nhl_players_id.................................. [PASS in 0.11s]
2022-02-07 07:42:11.944282 (Thread-3): finished collecting timing info
2022-02-07 07:42:11.944884 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_points".
2022-02-07 07:42:11.944969 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_points: BEGIN
2022-02-07 07:42:11.949198 (Thread-1): Finished running node test.data_eng_challenge.not_null_nhl_players_id
2022-02-07 07:42:11.955680 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:42:11.955835 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_points".
2022-02-07 07:42:11.955913 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_points: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_points"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where points is null


2022-02-07 07:42:11.957109 (Thread-3): SQL status: SELECT 1 in 0.00 seconds
2022-02-07 07:42:11.957423 (Thread-3): finished collecting timing info
2022-02-07 07:42:11.957696 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_points: ROLLBACK
2022-02-07 07:42:11.962923 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_points: Close
2022-02-07 07:42:11.964922 (Thread-3): 07:42:11 | 6 of 7 PASS not_null_nhl_players_points.............................. [PASS in 0.09s]
2022-02-07 07:42:11.965253 (Thread-3): Finished running node test.data_eng_challenge.not_null_nhl_players_points
2022-02-07 07:42:11.965706 (Thread-2): finished collecting timing info
2022-02-07 07:42:11.965984 (Thread-2): Using postgres connection "test.data_eng_challenge.unique_nhl_players_id".
2022-02-07 07:42:11.966062 (Thread-2): On test.data_eng_challenge.unique_nhl_players_id: BEGIN
2022-02-07 07:42:11.978247 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:42:11.978429 (Thread-2): Using postgres connection "test.data_eng_challenge.unique_nhl_players_id".
2022-02-07 07:42:11.978542 (Thread-2): On test.data_eng_challenge.unique_nhl_players_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.unique_nhl_players_id"} */




select count(*) as validation_errors
from (

    select
        id

    from "postgres"."public"."nhl_players"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2022-02-07 07:42:11.988981 (Thread-2): SQL status: SELECT 1 in 0.01 seconds
2022-02-07 07:42:11.989326 (Thread-2): finished collecting timing info
2022-02-07 07:42:11.989646 (Thread-2): On test.data_eng_challenge.unique_nhl_players_id: ROLLBACK
2022-02-07 07:42:11.994113 (Thread-2): On test.data_eng_challenge.unique_nhl_players_id: Close
2022-02-07 07:42:11.994655 (Thread-2): 07:42:11 | 7 of 7 FAIL 51 unique_nhl_players_id................................. [FAIL 51 in 0.07s]
2022-02-07 07:42:11.994987 (Thread-2): Finished running node test.data_eng_challenge.unique_nhl_players_id
2022-02-07 07:42:11.996216 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:42:11.996312 (MainThread): Opening a new connection, currently in state closed
2022-02-07 07:42:11.996542 (MainThread): 07:42:11 | 
2022-02-07 07:42:12.004654 (MainThread): 07:42:12 | Finished running 7 tests in 0.53s.
2022-02-07 07:42:12.004982 (MainThread): Connection 'master' was properly closed.
2022-02-07 07:42:12.005102 (MainThread): Connection 'test.data_eng_challenge.not_null_nhl_players_id' was properly closed.
2022-02-07 07:42:12.005197 (MainThread): Connection 'test.data_eng_challenge.unique_nhl_players_id' was properly closed.
2022-02-07 07:42:12.005259 (MainThread): Connection 'test.data_eng_challenge.not_null_nhl_players_points' was properly closed.
2022-02-07 07:42:12.054308 (MainThread): 
2022-02-07 07:42:12.054766 (MainThread): Completed with 2 errors and 0 warnings:
2022-02-07 07:42:12.054943 (MainThread): 
2022-02-07 07:42:12.055109 (MainThread): Failure in test greater_than_zero_points_leaders_points (models/mart/nhl/points_leaders.yml)
2022-02-07 07:42:12.055292 (MainThread):   Got 305 results, expected 0.
2022-02-07 07:42:12.055460 (MainThread): 
2022-02-07 07:42:12.055646 (MainThread):   compiled SQL at target/compiled/data_eng_challenge/models/mart/nhl/points_leaders.yml/schema_test/greater_than_zero_points_leaders_points.sql
2022-02-07 07:42:12.055798 (MainThread): 
2022-02-07 07:42:12.055948 (MainThread): Failure in test unique_nhl_players_id (models/base/nhl/nhl_players.yml)
2022-02-07 07:42:12.056120 (MainThread):   Got 51 results, expected 0.
2022-02-07 07:42:12.056266 (MainThread): 
2022-02-07 07:42:12.056411 (MainThread):   compiled SQL at target/compiled/data_eng_challenge/models/base/nhl/nhl_players.yml/schema_test/unique_nhl_players_id.sql
2022-02-07 07:42:12.056605 (MainThread): 
Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
2022-02-07 07:42:12.056860 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0fd326820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0fd3267c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0fd326520>]}
2022-02-07 07:42:12.057064 (MainThread): Flushing usage events
2022-02-07 07:47:25.176766 (MainThread): Running with dbt=0.17.2
2022-02-07 07:47:25.312840 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-07 07:47:25.315242 (MainThread): Tracking: tracking
2022-02-07 07:47:25.316798 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c9becaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c9bb9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c9bb93a0>]}
2022-02-07 07:47:25.364515 (MainThread): Partial parsing not enabled
2022-02-07 07:47:25.371125 (MainThread): Parsing macros/core.sql
2022-02-07 07:47:25.376425 (MainThread): Parsing macros/adapters/common.sql
2022-02-07 07:47:25.445227 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-07 07:47:25.446515 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-07 07:47:25.447411 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-07 07:47:25.448433 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-07 07:47:25.450525 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-07 07:47:25.453542 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-07 07:47:25.455201 (MainThread): Parsing macros/etc/query.sql
2022-02-07 07:47:25.456302 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-07 07:47:25.458272 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-07 07:47:25.459302 (MainThread): Parsing macros/etc/datetime.sql
2022-02-07 07:47:25.468541 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-07 07:47:25.477048 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-07 07:47:25.492068 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-07 07:47:25.522831 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-07 07:47:25.532538 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-07 07:47:25.536892 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-07 07:47:25.543894 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-07 07:47:25.549522 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-07 07:47:25.556836 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-07 07:47:25.584512 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-07 07:47:25.603270 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-07 07:47:25.605192 (MainThread): Parsing macros/adapters.sql
2022-02-07 07:47:25.625582 (MainThread): Parsing macros/catalog.sql
2022-02-07 07:47:25.627891 (MainThread): Parsing macros/relations.sql
2022-02-07 07:47:25.629562 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-07 07:47:25.651725 (MainThread): Partial parsing not enabled
2022-02-07 07:47:25.652145 (MainThread): Parsing macros/greater_than_zero.sql
2022-02-07 07:47:25.687439 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:47:25.687631 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:47:25.717349 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:47:25.717536 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:47:25.730061 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:47:25.730197 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:47:26.052752 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 135 macros, 0 operations, 0 seed files, 1 source
2022-02-07 07:47:26.054780 (MainThread): 
2022-02-07 07:47:26.059581 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:47:26.059706 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:47:26.067288 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-02-07 07:47:26.067457 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-07 07:47:26.086114 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-02-07 07:47:26.086337 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-02-07 07:47:26.104865 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.02 seconds
2022-02-07 07:47:26.107484 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-02-07 07:47:26.122730 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-07 07:47:26.123017 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-02-07 07:47:26.129582 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:47:26.129729 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-07 07:47:26.134715 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:47:26.134897 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:47:26.134996 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-07 07:47:26.144882 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.01 seconds
2022-02-07 07:47:26.154346 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-07 07:47:26.155737 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-07 07:47:26.186276 (MainThread): Using postgres connection "master".
2022-02-07 07:47:26.186538 (MainThread): On master: BEGIN
2022-02-07 07:47:26.203229 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-02-07 07:47:26.203452 (MainThread): Using postgres connection "master".
2022-02-07 07:47:26.203556 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-07 07:47:26.209537 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2022-02-07 07:47:26.220527 (MainThread): On master: ROLLBACK
2022-02-07 07:47:26.223549 (MainThread): Using postgres connection "master".
2022-02-07 07:47:26.223662 (MainThread): On master: BEGIN
2022-02-07 07:47:26.225629 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:47:26.225744 (MainThread): On master: COMMIT
2022-02-07 07:47:26.225825 (MainThread): Using postgres connection "master".
2022-02-07 07:47:26.225889 (MainThread): On master: COMMIT
2022-02-07 07:47:26.226091 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:47:26.226200 (MainThread): On master: Close
2022-02-07 07:47:26.230261 (MainThread): 07:47:26 | Concurrency: 3 threads (target='challenge')
2022-02-07 07:47:26.230570 (MainThread): 07:47:26 | 
2022-02-07 07:47:26.264282 (Thread-1): Began running node model.data_eng_challenge.player_game_stats
2022-02-07 07:47:26.266778 (Thread-1): 07:47:26 | 1 of 3 START view model public.player_game_stats..................... [RUN]
2022-02-07 07:47:26.268196 (Thread-1): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:47:26.268322 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:47:26.268452 (Thread-1): Compiling model.data_eng_challenge.player_game_stats
2022-02-07 07:47:26.296743 (Thread-1): Writing injected SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 07:47:26.306627 (Thread-1): finished collecting timing info
2022-02-07 07:47:26.367508 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:47:26.374475 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_tmp" cascade
2022-02-07 07:47:26.379124 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:47:26.382583 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:47:26.382748 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 07:47:26.384044 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:47:26.388568 (Thread-1): Writing runtime SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 07:47:26.389310 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:47:26.389467 (Thread-1): On model.data_eng_challenge.player_game_stats: BEGIN
2022-02-07 07:47:26.395991 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:47:26.396162 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:47:26.396238 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */

  create view "postgres"."public"."player_game_stats__dbt_tmp" as (
    select
        player_person_id as nhl_player_id,
        side,
        player_person_fullName full_name,
        player_person_currentTeam_name game_team_name,
        player_stats_skaterStats_assists stats_assists,
        player_stats_skaterStats_goals stats_goals
  from "postgres"."public"."game_stats"
  );

2022-02-07 07:47:26.400875 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2022-02-07 07:47:26.410268 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:47:26.410409 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats" rename to "player_game_stats__dbt_backup"
2022-02-07 07:47:26.424038 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2022-02-07 07:47:26.426445 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:47:26.426544 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats__dbt_tmp" rename to "player_game_stats"
2022-02-07 07:47:26.429748 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:47:26.439487 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 07:47:26.439675 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:47:26.439824 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 07:47:26.457689 (Thread-1): SQL status: COMMIT in 0.02 seconds
2022-02-07 07:47:26.461427 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:47:26.461588 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 07:47:26.496104 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2022-02-07 07:47:26.498641 (Thread-1): finished collecting timing info
2022-02-07 07:47:26.498876 (Thread-1): On model.data_eng_challenge.player_game_stats: Close
2022-02-07 07:47:26.500847 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfb3c3a1-1ca9-419a-afbf-e163dd6e462b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c606f490>]}
2022-02-07 07:47:26.501903 (Thread-1): 07:47:26 | 1 of 3 OK created view model public.player_game_stats................ [CREATE VIEW in 0.23s]
2022-02-07 07:47:26.502991 (Thread-1): Finished running node model.data_eng_challenge.player_game_stats
2022-02-07 07:47:26.503521 (Thread-3): Began running node model.data_eng_challenge.nhl_players
2022-02-07 07:47:26.504483 (Thread-3): 07:47:26 | 2 of 3 START view model public.nhl_players........................... [RUN]
2022-02-07 07:47:26.505775 (Thread-3): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:47:26.505905 (Thread-3): Opening a new connection, currently in state init
2022-02-07 07:47:26.506018 (Thread-3): Compiling model.data_eng_challenge.nhl_players
2022-02-07 07:47:26.540519 (Thread-3): Writing injected SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 07:47:26.543167 (Thread-3): finished collecting timing info
2022-02-07 07:47:26.549360 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:47:26.549483 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_tmp" cascade
2022-02-07 07:47:26.566039 (Thread-3): SQL status: DROP VIEW in 0.02 seconds
2022-02-07 07:47:26.573807 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:47:26.573967 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_backup" cascade
2022-02-07 07:47:26.574795 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:47:26.576037 (Thread-3): Writing runtime SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 07:47:26.580183 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:47:26.580292 (Thread-3): On model.data_eng_challenge.nhl_players: BEGIN
2022-02-07 07:47:26.580898 (Thread-3): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:47:26.580995 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:47:26.581061 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */

  create view "postgres"."public"."nhl_players__dbt_tmp" as (
    select
  nhl_player_id as id,
  full_name,
  game_team_name as team_name,
  sum(stats_assists) as assists,
  sum(stats_goals) as goals,
  (goals + assists) as points -- TODO replace this with correct columns
from "postgres"."public"."player_game_stats" --or whatever other table reference
group by id, full_name, game_team_name
  );

2022-02-07 07:47:26.601781 (Thread-3): Postgres error: column "goals" does not exist
LINE 10:   (goals + assists) as points -- TODO replace this with corr...
            ^

2022-02-07 07:47:26.601962 (Thread-3): On model.data_eng_challenge.nhl_players: ROLLBACK
2022-02-07 07:47:26.602251 (Thread-3): finished collecting timing info
2022-02-07 07:47:26.602520 (Thread-3): On model.data_eng_challenge.nhl_players: Close
2022-02-07 07:47:26.604037 (Thread-3): Database Error in model nhl_players (models/base/nhl/nhl_players.sql)
  column "goals" does not exist
  LINE 10:   (goals + assists) as points -- TODO replace this with corr...
              ^
  compiled SQL at target/run/data_eng_challenge/models/base/nhl/nhl_players.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 77, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "goals" does not exist
LINE 10:   (goals + assists) as points -- TODO replace this with corr...
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 122, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 85, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 57, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model nhl_players (models/base/nhl/nhl_players.sql)
  column "goals" does not exist
  LINE 10:   (goals + assists) as points -- TODO replace this with corr...
              ^
  compiled SQL at target/run/data_eng_challenge/models/base/nhl/nhl_players.sql
2022-02-07 07:47:26.684427 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfb3c3a1-1ca9-419a-afbf-e163dd6e462b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c60406a0>]}
2022-02-07 07:47:26.685705 (Thread-3): 07:47:26 | 2 of 3 ERROR creating view model public.nhl_players.................. [ERROR in 0.18s]
2022-02-07 07:47:26.686140 (Thread-3): Finished running node model.data_eng_challenge.nhl_players
2022-02-07 07:47:26.686751 (Thread-2): Began running node model.data_eng_challenge.points_leaders
2022-02-07 07:47:26.686877 (Thread-2): 07:47:26 | 3 of 3 SKIP relation public.points_leaders........................... [SKIP]
2022-02-07 07:47:26.687908 (Thread-2): Finished running node model.data_eng_challenge.points_leaders
2022-02-07 07:47:26.688947 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:47:26.689068 (MainThread): Opening a new connection, currently in state closed
2022-02-07 07:47:26.689195 (MainThread): Using postgres connection "master".
2022-02-07 07:47:26.689262 (MainThread): On master: BEGIN
2022-02-07 07:47:26.712697 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-02-07 07:47:26.712916 (MainThread): On master: COMMIT
2022-02-07 07:47:26.713012 (MainThread): Using postgres connection "master".
2022-02-07 07:47:26.713090 (MainThread): On master: COMMIT
2022-02-07 07:47:26.713568 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:47:26.713682 (MainThread): On master: Close
2022-02-07 07:47:26.715266 (MainThread): 07:47:26 | 
2022-02-07 07:47:26.715659 (MainThread): 07:47:26 | Finished running 3 view models in 0.66s.
2022-02-07 07:47:26.715844 (MainThread): Connection 'master' was properly closed.
2022-02-07 07:47:26.715918 (MainThread): Connection 'list_postgres' was properly closed.
2022-02-07 07:47:26.715990 (MainThread): Connection 'model.data_eng_challenge.player_game_stats' was properly closed.
2022-02-07 07:47:26.716064 (MainThread): Connection 'model.data_eng_challenge.nhl_players' was properly closed.
2022-02-07 07:47:26.730944 (MainThread): 
2022-02-07 07:47:26.731328 (MainThread): Completed with 1 error and 0 warnings:
2022-02-07 07:47:26.731504 (MainThread): 
2022-02-07 07:47:26.731667 (MainThread): Database Error in model nhl_players (models/base/nhl/nhl_players.sql)
2022-02-07 07:47:26.731819 (MainThread):   column "goals" does not exist
2022-02-07 07:47:26.731957 (MainThread):   LINE 10:   (goals + assists) as points -- TODO replace this with corr...
2022-02-07 07:47:26.732120 (MainThread):               ^
2022-02-07 07:47:26.732268 (MainThread):   compiled SQL at target/run/data_eng_challenge/models/base/nhl/nhl_players.sql
2022-02-07 07:47:26.732424 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2022-02-07 07:47:26.732664 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c7281250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c61f1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c60b98b0>]}
2022-02-07 07:47:26.732856 (MainThread): Flushing usage events
2022-02-07 07:48:29.515783 (MainThread): Running with dbt=0.17.2
2022-02-07 07:48:29.630352 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-07 07:48:29.631827 (MainThread): Tracking: tracking
2022-02-07 07:48:29.635578 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0ec57ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0ec23940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0ec23370>]}
2022-02-07 07:48:29.681639 (MainThread): Partial parsing not enabled
2022-02-07 07:48:29.692260 (MainThread): Parsing macros/core.sql
2022-02-07 07:48:29.697472 (MainThread): Parsing macros/adapters/common.sql
2022-02-07 07:48:29.759606 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-07 07:48:29.760914 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-07 07:48:29.761861 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-07 07:48:29.762941 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-07 07:48:29.764951 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-07 07:48:29.766508 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-07 07:48:29.768050 (MainThread): Parsing macros/etc/query.sql
2022-02-07 07:48:29.770174 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-07 07:48:29.772111 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-07 07:48:29.773112 (MainThread): Parsing macros/etc/datetime.sql
2022-02-07 07:48:29.783860 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-07 07:48:29.791756 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-07 07:48:29.805587 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-07 07:48:29.827841 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-07 07:48:29.834438 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-07 07:48:29.836358 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-07 07:48:29.843147 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-07 07:48:29.848098 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-07 07:48:29.855624 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-07 07:48:29.884646 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-07 07:48:29.902011 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-07 07:48:29.904710 (MainThread): Parsing macros/adapters.sql
2022-02-07 07:48:29.925493 (MainThread): Parsing macros/catalog.sql
2022-02-07 07:48:29.927905 (MainThread): Parsing macros/relations.sql
2022-02-07 07:48:29.929321 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-07 07:48:29.951185 (MainThread): Partial parsing not enabled
2022-02-07 07:48:29.951646 (MainThread): Parsing macros/greater_than_zero.sql
2022-02-07 07:48:29.984502 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:48:29.984686 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:48:30.015299 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:48:30.015488 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:48:30.027294 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:48:30.027454 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:48:30.338092 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 135 macros, 0 operations, 0 seed files, 1 source
2022-02-07 07:48:30.340280 (MainThread): 
2022-02-07 07:48:30.345194 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:48:30.345329 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:48:30.354651 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-02-07 07:48:30.354841 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-07 07:48:30.377257 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-02-07 07:48:30.387759 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-02-07 07:48:30.398588 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2022-02-07 07:48:30.401217 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-02-07 07:48:30.426610 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-07 07:48:30.426899 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-02-07 07:48:30.433273 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:48:30.433416 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-07 07:48:30.438381 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:48:30.438620 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:48:30.438738 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-07 07:48:30.442372 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2022-02-07 07:48:30.444642 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-07 07:48:30.444894 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-07 07:48:30.480067 (MainThread): Using postgres connection "master".
2022-02-07 07:48:30.480242 (MainThread): On master: BEGIN
2022-02-07 07:48:30.488634 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:48:30.488847 (MainThread): Using postgres connection "master".
2022-02-07 07:48:30.488930 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-07 07:48:30.507384 (MainThread): SQL status: SELECT 1 in 0.02 seconds
2022-02-07 07:48:30.509318 (MainThread): On master: ROLLBACK
2022-02-07 07:48:30.511702 (MainThread): Using postgres connection "master".
2022-02-07 07:48:30.511811 (MainThread): On master: BEGIN
2022-02-07 07:48:30.512552 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:48:30.512657 (MainThread): On master: COMMIT
2022-02-07 07:48:30.512733 (MainThread): Using postgres connection "master".
2022-02-07 07:48:30.512797 (MainThread): On master: COMMIT
2022-02-07 07:48:30.512971 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:48:30.513093 (MainThread): On master: Close
2022-02-07 07:48:30.513464 (MainThread): 07:48:30 | Concurrency: 3 threads (target='challenge')
2022-02-07 07:48:30.513722 (MainThread): 07:48:30 | 
2022-02-07 07:48:30.552158 (Thread-1): Began running node model.data_eng_challenge.player_game_stats
2022-02-07 07:48:30.555425 (Thread-1): 07:48:30 | 1 of 3 START view model public.player_game_stats..................... [RUN]
2022-02-07 07:48:30.559864 (Thread-1): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:48:30.559998 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:48:30.560108 (Thread-1): Compiling model.data_eng_challenge.player_game_stats
2022-02-07 07:48:30.600587 (Thread-1): Writing injected SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 07:48:30.611785 (Thread-1): finished collecting timing info
2022-02-07 07:48:30.660839 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:48:30.661092 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_tmp" cascade
2022-02-07 07:48:30.679370 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:48:30.681885 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:48:30.681989 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 07:48:30.686307 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:48:30.693259 (Thread-1): Writing runtime SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 07:48:30.699798 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:48:30.699920 (Thread-1): On model.data_eng_challenge.player_game_stats: BEGIN
2022-02-07 07:48:30.700885 (Thread-1): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:48:30.701015 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:48:30.701090 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */

  create view "postgres"."public"."player_game_stats__dbt_tmp" as (
    select
        player_person_id as nhl_player_id,
        side,
        player_person_fullName full_name,
        player_person_currentTeam_name game_team_name,
        player_stats_skaterStats_assists stats_assists,
        player_stats_skaterStats_goals stats_goals
  from "postgres"."public"."game_stats"
  );

2022-02-07 07:48:30.707114 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-02-07 07:48:30.716296 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:48:30.716422 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats" rename to "player_game_stats__dbt_backup"
2022-02-07 07:48:30.727071 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2022-02-07 07:48:30.733488 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:48:30.733641 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats__dbt_tmp" rename to "player_game_stats"
2022-02-07 07:48:30.734826 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:48:30.748835 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 07:48:30.759003 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:48:30.759181 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 07:48:30.789307 (Thread-1): SQL status: COMMIT in 0.03 seconds
2022-02-07 07:48:30.793150 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:48:30.793304 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 07:48:30.798461 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 07:48:30.800949 (Thread-1): finished collecting timing info
2022-02-07 07:48:30.801222 (Thread-1): On model.data_eng_challenge.player_game_stats: Close
2022-02-07 07:48:30.803413 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cad529d-2887-497b-9e12-557bb9c46c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0b900fa0>]}
2022-02-07 07:48:30.804515 (Thread-1): 07:48:30 | 1 of 3 OK created view model public.player_game_stats................ [CREATE VIEW in 0.24s]
2022-02-07 07:48:30.806031 (Thread-1): Finished running node model.data_eng_challenge.player_game_stats
2022-02-07 07:48:30.806811 (Thread-3): Began running node model.data_eng_challenge.nhl_players
2022-02-07 07:48:30.807945 (Thread-3): 07:48:30 | 2 of 3 START view model public.nhl_players........................... [RUN]
2022-02-07 07:48:30.809346 (Thread-3): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:48:30.809473 (Thread-3): Opening a new connection, currently in state init
2022-02-07 07:48:30.809586 (Thread-3): Compiling model.data_eng_challenge.nhl_players
2022-02-07 07:48:30.827665 (Thread-3): Writing injected SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 07:48:30.840906 (Thread-3): finished collecting timing info
2022-02-07 07:48:30.859889 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:48:30.860743 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_tmp" cascade
2022-02-07 07:48:30.865680 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:48:30.868343 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:48:30.868495 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_backup" cascade
2022-02-07 07:48:30.873345 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:48:30.874785 (Thread-3): Writing runtime SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 07:48:30.879109 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:48:30.879284 (Thread-3): On model.data_eng_challenge.nhl_players: BEGIN
2022-02-07 07:48:30.880032 (Thread-3): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:48:30.880134 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:48:30.880203 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */

  create view "postgres"."public"."nhl_players__dbt_tmp" as (
    select *, (goals + assists) as points from(
select
  nhl_player_id as id,
  full_name,
  game_team_name as team_name,
  sum(stats_assists) as assists,
  sum(stats_goals) as goals, -- TODO replace this with correct columns
from "postgres"."public"."player_game_stats" --or whatever other table reference
group by id, full_name, game_team_name)
  );

2022-02-07 07:48:30.881109 (Thread-3): Postgres error: syntax error at or near "from"
LINE 11: from "postgres"."public"."player_game_stats" --or whatever o...
         ^

2022-02-07 07:48:30.881208 (Thread-3): On model.data_eng_challenge.nhl_players: ROLLBACK
2022-02-07 07:48:30.882718 (Thread-3): finished collecting timing info
2022-02-07 07:48:30.882997 (Thread-3): On model.data_eng_challenge.nhl_players: Close
2022-02-07 07:48:30.886360 (Thread-3): Database Error in model nhl_players (models/base/nhl/nhl_players.sql)
  syntax error at or near "from"
  LINE 11: from "postgres"."public"."player_game_stats" --or whatever o...
           ^
  compiled SQL at target/run/data_eng_challenge/models/base/nhl/nhl_players.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 77, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "from"
LINE 11: from "postgres"."public"."player_game_stats" --or whatever o...
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 122, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 85, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 57, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model nhl_players (models/base/nhl/nhl_players.sql)
  syntax error at or near "from"
  LINE 11: from "postgres"."public"."player_game_stats" --or whatever o...
           ^
  compiled SQL at target/run/data_eng_challenge/models/base/nhl/nhl_players.sql
2022-02-07 07:48:30.890206 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cad529d-2887-497b-9e12-557bb9c46c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0c3515b0>]}
2022-02-07 07:48:30.891517 (Thread-3): 07:48:30 | 2 of 3 ERROR creating view model public.nhl_players.................. [ERROR in 0.08s]
2022-02-07 07:48:30.893438 (Thread-3): Finished running node model.data_eng_challenge.nhl_players
2022-02-07 07:48:30.894103 (Thread-2): Began running node model.data_eng_challenge.points_leaders
2022-02-07 07:48:30.894242 (Thread-2): 07:48:30 | 3 of 3 SKIP relation public.points_leaders........................... [SKIP]
2022-02-07 07:48:30.894454 (Thread-2): Finished running node model.data_eng_challenge.points_leaders
2022-02-07 07:48:30.897436 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:48:30.897541 (MainThread): Opening a new connection, currently in state closed
2022-02-07 07:48:30.897648 (MainThread): Using postgres connection "master".
2022-02-07 07:48:30.897898 (MainThread): On master: BEGIN
2022-02-07 07:48:30.908135 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:48:30.908339 (MainThread): On master: COMMIT
2022-02-07 07:48:30.908432 (MainThread): Using postgres connection "master".
2022-02-07 07:48:30.908528 (MainThread): On master: COMMIT
2022-02-07 07:48:30.908727 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:48:30.908834 (MainThread): On master: Close
2022-02-07 07:48:30.910334 (MainThread): 07:48:30 | 
2022-02-07 07:48:30.910658 (MainThread): 07:48:30 | Finished running 3 view models in 0.57s.
2022-02-07 07:48:30.912048 (MainThread): Connection 'master' was properly closed.
2022-02-07 07:48:30.912142 (MainThread): Connection 'model.data_eng_challenge.player_game_stats' was properly closed.
2022-02-07 07:48:30.912210 (MainThread): Connection 'model.data_eng_challenge.nhl_players' was properly closed.
2022-02-07 07:48:30.935138 (MainThread): 
2022-02-07 07:48:30.937249 (MainThread): Completed with 1 error and 0 warnings:
2022-02-07 07:48:30.938406 (MainThread): 
2022-02-07 07:48:30.943655 (MainThread): Database Error in model nhl_players (models/base/nhl/nhl_players.sql)
2022-02-07 07:48:30.943872 (MainThread):   syntax error at or near "from"
2022-02-07 07:48:30.944030 (MainThread):   LINE 11: from "postgres"."public"."player_game_stats" --or whatever o...
2022-02-07 07:48:30.944183 (MainThread):            ^
2022-02-07 07:48:30.944330 (MainThread):   compiled SQL at target/run/data_eng_challenge/models/base/nhl/nhl_players.sql
2022-02-07 07:48:30.944496 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2022-02-07 07:48:30.944785 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0b921f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0b921ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0b921a00>]}
2022-02-07 07:48:30.944993 (MainThread): Flushing usage events
2022-02-07 07:50:36.227049 (MainThread): Running with dbt=0.17.2
2022-02-07 07:50:36.332733 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-07 07:50:36.334085 (MainThread): Tracking: tracking
2022-02-07 07:50:36.339762 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae757c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae75464c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae7546430>]}
2022-02-07 07:50:36.382250 (MainThread): Partial parsing not enabled
2022-02-07 07:50:36.390179 (MainThread): Parsing macros/core.sql
2022-02-07 07:50:36.395121 (MainThread): Parsing macros/adapters/common.sql
2022-02-07 07:50:36.469829 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-07 07:50:36.472845 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-07 07:50:36.473832 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-07 07:50:36.474854 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-07 07:50:36.476712 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-07 07:50:36.478343 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-07 07:50:36.479848 (MainThread): Parsing macros/etc/query.sql
2022-02-07 07:50:36.480848 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-07 07:50:36.483652 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-07 07:50:36.484598 (MainThread): Parsing macros/etc/datetime.sql
2022-02-07 07:50:36.493882 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-07 07:50:36.501105 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-07 07:50:36.518768 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-07 07:50:36.540812 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-07 07:50:36.547993 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-07 07:50:36.549798 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-07 07:50:36.555726 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-07 07:50:36.560920 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-07 07:50:36.567001 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-07 07:50:36.594163 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-07 07:50:36.610818 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-07 07:50:36.613496 (MainThread): Parsing macros/adapters.sql
2022-02-07 07:50:36.634318 (MainThread): Parsing macros/catalog.sql
2022-02-07 07:50:36.636504 (MainThread): Parsing macros/relations.sql
2022-02-07 07:50:36.637942 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-07 07:50:36.659323 (MainThread): Partial parsing not enabled
2022-02-07 07:50:36.659696 (MainThread): Parsing macros/greater_than_zero.sql
2022-02-07 07:50:36.691263 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:50:36.691442 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:50:36.717867 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:50:36.718016 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:50:36.730314 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:50:36.730451 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:50:37.027192 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 135 macros, 0 operations, 0 seed files, 1 source
2022-02-07 07:50:37.029580 (MainThread): 
2022-02-07 07:50:37.034108 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:50:37.034228 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:50:37.044072 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-02-07 07:50:37.044252 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-07 07:50:37.061738 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-02-07 07:50:37.062009 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-02-07 07:50:37.067586 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2022-02-07 07:50:37.070000 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-02-07 07:50:37.102844 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-07 07:50:37.103066 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-02-07 07:50:37.117781 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:50:37.117974 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-07 07:50:37.123062 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:50:37.123254 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:50:37.123355 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-07 07:50:37.127093 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2022-02-07 07:50:37.129309 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-07 07:50:37.129570 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-07 07:50:37.169289 (MainThread): Using postgres connection "master".
2022-02-07 07:50:37.183517 (MainThread): On master: BEGIN
2022-02-07 07:50:37.193009 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:50:37.193240 (MainThread): Using postgres connection "master".
2022-02-07 07:50:37.193339 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-07 07:50:37.199511 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-02-07 07:50:37.201517 (MainThread): On master: ROLLBACK
2022-02-07 07:50:37.201841 (MainThread): Using postgres connection "master".
2022-02-07 07:50:37.201976 (MainThread): On master: BEGIN
2022-02-07 07:50:37.206786 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:50:37.207004 (MainThread): On master: COMMIT
2022-02-07 07:50:37.207095 (MainThread): Using postgres connection "master".
2022-02-07 07:50:37.207164 (MainThread): On master: COMMIT
2022-02-07 07:50:37.209602 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:50:37.209760 (MainThread): On master: Close
2022-02-07 07:50:37.210180 (MainThread): 07:50:37 | Concurrency: 3 threads (target='challenge')
2022-02-07 07:50:37.213738 (MainThread): 07:50:37 | 
2022-02-07 07:50:37.244663 (Thread-1): Began running node model.data_eng_challenge.player_game_stats
2022-02-07 07:50:37.245827 (Thread-1): 07:50:37 | 1 of 3 START view model public.player_game_stats..................... [RUN]
2022-02-07 07:50:37.249245 (Thread-1): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:50:37.249367 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:50:37.249467 (Thread-1): Compiling model.data_eng_challenge.player_game_stats
2022-02-07 07:50:37.277175 (Thread-1): Writing injected SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 07:50:37.291412 (Thread-1): finished collecting timing info
2022-02-07 07:50:37.334929 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:50:37.335173 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_tmp" cascade
2022-02-07 07:50:37.341544 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 07:50:37.349199 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:50:37.349400 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 07:50:37.350810 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:50:37.360456 (Thread-1): Writing runtime SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 07:50:37.363776 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:50:37.363879 (Thread-1): On model.data_eng_challenge.player_game_stats: BEGIN
2022-02-07 07:50:37.365826 (Thread-1): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:50:37.365926 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:50:37.365995 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */

  create view "postgres"."public"."player_game_stats__dbt_tmp" as (
    select
        player_person_id as nhl_player_id,
        side,
        player_person_fullName full_name,
        player_person_currentTeam_name game_team_name,
        player_stats_skaterStats_assists stats_assists,
        player_stats_skaterStats_goals stats_goals
  from "postgres"."public"."game_stats"
  );

2022-02-07 07:50:37.370652 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2022-02-07 07:50:37.392264 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:50:37.392513 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats" rename to "player_game_stats__dbt_backup"
2022-02-07 07:50:37.395102 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:50:37.400848 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:50:37.400987 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats__dbt_tmp" rename to "player_game_stats"
2022-02-07 07:50:37.402993 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:50:37.423919 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 07:50:37.426560 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:50:37.426654 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 07:50:37.447852 (Thread-1): SQL status: COMMIT in 0.02 seconds
2022-02-07 07:50:37.451540 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:50:37.451646 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 07:50:37.463399 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 07:50:37.465955 (Thread-1): finished collecting timing info
2022-02-07 07:50:37.466217 (Thread-1): On model.data_eng_challenge.player_game_stats: Close
2022-02-07 07:50:37.468163 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2ba351-f6f5-4675-881c-853f8014c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae4224f10>]}
2022-02-07 07:50:37.469201 (Thread-1): 07:50:37 | 1 of 3 OK created view model public.player_game_stats................ [CREATE VIEW in 0.22s]
2022-02-07 07:50:37.471516 (Thread-1): Finished running node model.data_eng_challenge.player_game_stats
2022-02-07 07:50:37.472088 (Thread-3): Began running node model.data_eng_challenge.nhl_players
2022-02-07 07:50:37.473062 (Thread-3): 07:50:37 | 2 of 3 START view model public.nhl_players........................... [RUN]
2022-02-07 07:50:37.474242 (Thread-3): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:50:37.474357 (Thread-3): Opening a new connection, currently in state init
2022-02-07 07:50:37.474462 (Thread-3): Compiling model.data_eng_challenge.nhl_players
2022-02-07 07:50:37.487319 (Thread-3): Writing injected SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 07:50:37.488083 (Thread-3): finished collecting timing info
2022-02-07 07:50:37.494369 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:50:37.494511 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_tmp" cascade
2022-02-07 07:50:37.499453 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:50:37.507621 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:50:37.507870 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_backup" cascade
2022-02-07 07:50:37.508696 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:50:37.509975 (Thread-3): Writing runtime SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 07:50:37.510459 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:50:37.510564 (Thread-3): On model.data_eng_challenge.nhl_players: BEGIN
2022-02-07 07:50:37.513836 (Thread-3): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:50:37.513936 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:50:37.514028 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */

  create view "postgres"."public"."nhl_players__dbt_tmp" as (
    select
  nhl_player_id as id,
  full_name,
  game_team_name as team_name,
  sum(stats_assists) as assists,
  sum(stats_goals) as goals,
  (sum(stats_goals) + sum(stats_assists)) as points -- TODO replace this with correct columns
from "postgres"."public"."player_game_stats" --or whatever other table reference
group by id, full_name, game_team_name
  );

2022-02-07 07:50:37.566289 (Thread-3): SQL status: CREATE VIEW in 0.05 seconds
2022-02-07 07:50:37.568791 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:50:37.568893 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
alter table "postgres"."public"."nhl_players__dbt_tmp" rename to "nhl_players"
2022-02-07 07:50:37.570804 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:50:37.571851 (Thread-3): On model.data_eng_challenge.nhl_players: COMMIT
2022-02-07 07:50:37.571942 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:50:37.572008 (Thread-3): On model.data_eng_challenge.nhl_players: COMMIT
2022-02-07 07:50:37.575909 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:50:37.577331 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:50:37.577423 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_backup" cascade
2022-02-07 07:50:37.578147 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:50:37.580319 (Thread-3): finished collecting timing info
2022-02-07 07:50:37.580535 (Thread-3): On model.data_eng_challenge.nhl_players: Close
2022-02-07 07:50:37.588736 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2ba351-f6f5-4675-881c-853f8014c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae4dc4f10>]}
2022-02-07 07:50:37.589919 (Thread-3): 07:50:37 | 2 of 3 OK created view model public.nhl_players...................... [CREATE VIEW in 0.11s]
2022-02-07 07:50:37.592640 (Thread-3): Finished running node model.data_eng_challenge.nhl_players
2022-02-07 07:50:37.593151 (Thread-2): Began running node model.data_eng_challenge.points_leaders
2022-02-07 07:50:37.594309 (Thread-2): 07:50:37 | 3 of 3 START view model public.points_leaders........................ [RUN]
2022-02-07 07:50:37.597192 (Thread-2): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:50:37.597286 (Thread-2): Opening a new connection, currently in state init
2022-02-07 07:50:37.597384 (Thread-2): Compiling model.data_eng_challenge.points_leaders
2022-02-07 07:50:37.604744 (Thread-2): Writing injected SQL for node "model.data_eng_challenge.points_leaders"
2022-02-07 07:50:37.605168 (Thread-2): finished collecting timing info
2022-02-07 07:50:37.625601 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:50:37.636184 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_tmp" cascade
2022-02-07 07:50:37.643893 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 07:50:37.646220 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:50:37.646321 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_backup" cascade
2022-02-07 07:50:37.650789 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:50:37.652029 (Thread-2): Writing runtime SQL for node "model.data_eng_challenge.points_leaders"
2022-02-07 07:50:37.652471 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:50:37.652564 (Thread-2): On model.data_eng_challenge.points_leaders: BEGIN
2022-02-07 07:50:37.655176 (Thread-2): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:50:37.655292 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:50:37.655362 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */

  create view "postgres"."public"."points_leaders__dbt_tmp" as (
    select 
* -- TODO replace with correct projection columns
from "postgres"."public"."nhl_players"  -- or other tables
  );

2022-02-07 07:50:37.660202 (Thread-2): SQL status: CREATE VIEW in 0.00 seconds
2022-02-07 07:50:37.663415 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:50:37.663515 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
alter table "postgres"."public"."points_leaders__dbt_tmp" rename to "points_leaders"
2022-02-07 07:50:37.666870 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:50:37.668001 (Thread-2): On model.data_eng_challenge.points_leaders: COMMIT
2022-02-07 07:50:37.668092 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:50:37.668177 (Thread-2): On model.data_eng_challenge.points_leaders: COMMIT
2022-02-07 07:50:37.691541 (Thread-2): SQL status: COMMIT in 0.02 seconds
2022-02-07 07:50:37.693187 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:50:37.693278 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_backup" cascade
2022-02-07 07:50:37.694237 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:50:37.696499 (Thread-2): finished collecting timing info
2022-02-07 07:50:37.696716 (Thread-2): On model.data_eng_challenge.points_leaders: Close
2022-02-07 07:50:37.710050 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2ba351-f6f5-4675-881c-853f8014c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae4235520>]}
2022-02-07 07:50:37.711223 (Thread-2): 07:50:37 | 3 of 3 OK created view model public.points_leaders................... [CREATE VIEW in 0.11s]
2022-02-07 07:50:37.714097 (Thread-2): Finished running node model.data_eng_challenge.points_leaders
2022-02-07 07:50:37.715174 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:50:37.715269 (MainThread): Opening a new connection, currently in state closed
2022-02-07 07:50:37.715369 (MainThread): Using postgres connection "master".
2022-02-07 07:50:37.715434 (MainThread): On master: BEGIN
2022-02-07 07:50:37.723066 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:50:37.723224 (MainThread): On master: COMMIT
2022-02-07 07:50:37.723296 (MainThread): Using postgres connection "master".
2022-02-07 07:50:37.723361 (MainThread): On master: COMMIT
2022-02-07 07:50:37.723551 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:50:37.723654 (MainThread): On master: Close
2022-02-07 07:50:37.726717 (MainThread): 07:50:37 | 
2022-02-07 07:50:37.726994 (MainThread): 07:50:37 | Finished running 3 view models in 0.69s.
2022-02-07 07:50:37.727235 (MainThread): Connection 'master' was properly closed.
2022-02-07 07:50:37.727311 (MainThread): Connection 'model.data_eng_challenge.player_game_stats' was properly closed.
2022-02-07 07:50:37.727370 (MainThread): Connection 'model.data_eng_challenge.nhl_players' was properly closed.
2022-02-07 07:50:37.727425 (MainThread): Connection 'model.data_eng_challenge.points_leaders' was properly closed.
2022-02-07 07:50:37.745290 (MainThread): 
2022-02-07 07:50:37.747004 (MainThread): Completed successfully
2022-02-07 07:50:37.747257 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-02-07 07:50:37.747529 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae4356580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae42451f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae42458b0>]}
2022-02-07 07:50:37.747731 (MainThread): Flushing usage events
2022-02-07 07:51:19.743087 (MainThread): Running with dbt=0.17.2
2022-02-07 07:51:19.846273 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-02-07 07:51:19.847711 (MainThread): Tracking: tracking
2022-02-07 07:51:19.849269 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1a0f7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1a0c4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1a0c43a0>]}
2022-02-07 07:51:19.901915 (MainThread): Partial parsing not enabled
2022-02-07 07:51:19.917514 (MainThread): Parsing macros/core.sql
2022-02-07 07:51:19.922753 (MainThread): Parsing macros/adapters/common.sql
2022-02-07 07:51:19.991077 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-07 07:51:19.992480 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-07 07:51:19.993507 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-07 07:51:19.994634 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-07 07:51:19.996558 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-07 07:51:19.998973 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-07 07:51:20.000484 (MainThread): Parsing macros/etc/query.sql
2022-02-07 07:51:20.001514 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-07 07:51:20.003368 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-07 07:51:20.004355 (MainThread): Parsing macros/etc/datetime.sql
2022-02-07 07:51:20.014231 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-07 07:51:20.021989 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-07 07:51:20.039598 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-07 07:51:20.061384 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-07 07:51:20.067766 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-07 07:51:20.070370 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-07 07:51:20.076239 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-07 07:51:20.082209 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-07 07:51:20.089460 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-07 07:51:20.117784 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-07 07:51:20.138750 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-07 07:51:20.140622 (MainThread): Parsing macros/adapters.sql
2022-02-07 07:51:20.161844 (MainThread): Parsing macros/catalog.sql
2022-02-07 07:51:20.164508 (MainThread): Parsing macros/relations.sql
2022-02-07 07:51:20.165886 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-07 07:51:20.187625 (MainThread): Partial parsing not enabled
2022-02-07 07:51:20.188454 (MainThread): Parsing macros/greater_than_zero.sql
2022-02-07 07:51:20.229084 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:51:20.229336 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:51:20.257566 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:51:20.257749 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:51:20.273501 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:51:20.273708 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:51:20.638025 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 135 macros, 0 operations, 0 seed files, 1 source
2022-02-07 07:51:20.648006 (MainThread): 
2022-02-07 07:51:20.648429 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:51:20.648560 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:51:20.673380 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-07 07:51:20.677909 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-02-07 07:51:20.698900 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:51:20.699076 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-07 07:51:20.709917 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:51:20.710073 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:51:20.710140 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-07 07:51:20.713336 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2022-02-07 07:51:20.718420 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-07 07:51:20.728163 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-07 07:51:20.756191 (MainThread): Using postgres connection "master".
2022-02-07 07:51:20.760436 (MainThread): On master: BEGIN
2022-02-07 07:51:20.766412 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:51:20.766627 (MainThread): Using postgres connection "master".
2022-02-07 07:51:20.766727 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-07 07:51:20.790104 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-02-07 07:51:20.797577 (MainThread): On master: ROLLBACK
2022-02-07 07:51:20.799965 (MainThread): On master: Close
2022-02-07 07:51:20.803774 (MainThread): 07:51:20 | Concurrency: 3 threads (target='challenge')
2022-02-07 07:51:20.804197 (MainThread): 07:51:20 | 
2022-02-07 07:51:20.838355 (Thread-1): Began running node test.data_eng_challenge.greater_than_zero_points_leaders_points
2022-02-07 07:51:20.838597 (Thread-1): 07:51:20 | 1 of 7 START test greater_than_zero_points_leaders_points............ [RUN]
2022-02-07 07:51:20.840274 (Thread-2): Began running node test.data_eng_challenge.not_null_nhl_players_assists
2022-02-07 07:51:20.840411 (Thread-2): 07:51:20 | 2 of 7 START test not_null_nhl_players_assists....................... [RUN]
2022-02-07 07:51:20.840540 (Thread-3): Began running node test.data_eng_challenge.not_null_nhl_players_full_name
2022-02-07 07:51:20.840651 (Thread-3): 07:51:20 | 3 of 7 START test not_null_nhl_players_full_name..................... [RUN]
2022-02-07 07:51:20.840970 (Thread-1): Acquiring new postgres connection "test.data_eng_challenge.greater_than_zero_points_leaders_points".
2022-02-07 07:51:20.841047 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:51:20.841142 (Thread-1): Compiling test.data_eng_challenge.greater_than_zero_points_leaders_points
2022-02-07 07:51:20.881652 (Thread-2): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_assists".
2022-02-07 07:51:20.881818 (Thread-2): Opening a new connection, currently in state init
2022-02-07 07:51:20.881905 (Thread-2): Compiling test.data_eng_challenge.not_null_nhl_players_assists
2022-02-07 07:51:20.902772 (Thread-2): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_assists"
2022-02-07 07:51:20.913557 (Thread-3): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_full_name".
2022-02-07 07:51:20.923545 (Thread-3): Opening a new connection, currently in state init
2022-02-07 07:51:20.923653 (Thread-3): Compiling test.data_eng_challenge.not_null_nhl_players_full_name
2022-02-07 07:51:20.914100 (Thread-2): finished collecting timing info
2022-02-07 07:51:20.940810 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_assists".
2022-02-07 07:51:20.940915 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: BEGIN
2022-02-07 07:51:20.913133 (Thread-1): Writing injected SQL for node "test.data_eng_challenge.greater_than_zero_points_leaders_points"
2022-02-07 07:51:20.943789 (Thread-1): finished collecting timing info
2022-02-07 07:51:20.944051 (Thread-1): Using postgres connection "test.data_eng_challenge.greater_than_zero_points_leaders_points".
2022-02-07 07:51:20.944129 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: BEGIN
2022-02-07 07:51:20.951102 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:51:20.951266 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_assists".
2022-02-07 07:51:20.951341 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_assists"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where assists is null


2022-02-07 07:51:20.935986 (Thread-3): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_full_name"
2022-02-07 07:51:20.959765 (Thread-3): finished collecting timing info
2022-02-07 07:51:20.960138 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_full_name".
2022-02-07 07:51:20.960221 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: BEGIN
2022-02-07 07:51:20.964251 (Thread-2): SQL status: SELECT 1 in 0.01 seconds
2022-02-07 07:51:20.964563 (Thread-2): finished collecting timing info
2022-02-07 07:51:20.964833 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: ROLLBACK
2022-02-07 07:51:20.976708 (Thread-1): SQL status: BEGIN in 0.03 seconds
2022-02-07 07:51:20.976929 (Thread-1): Using postgres connection "test.data_eng_challenge.greater_than_zero_points_leaders_points".
2022-02-07 07:51:20.977015 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.greater_than_zero_points_leaders_points"} */




select count(*)
from (
    select
      points    

    from "postgres"."public"."points_leaders"

    where points <= 0

) validation_errors


2022-02-07 07:51:20.985581 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: Close
2022-02-07 07:51:20.986133 (Thread-2): 07:51:20 | 2 of 7 PASS not_null_nhl_players_assists............................. [PASS in 0.10s]
2022-02-07 07:51:20.986463 (Thread-2): Finished running node test.data_eng_challenge.not_null_nhl_players_assists
2022-02-07 07:51:20.986608 (Thread-2): Began running node test.data_eng_challenge.not_null_nhl_players_goals
2022-02-07 07:51:20.986891 (Thread-2): 07:51:20 | 4 of 7 START test not_null_nhl_players_goals......................... [RUN]
2022-02-07 07:51:20.988568 (Thread-2): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_goals".
2022-02-07 07:51:20.988659 (Thread-2): Opening a new connection, currently in state closed
2022-02-07 07:51:20.988790 (Thread-2): Compiling test.data_eng_challenge.not_null_nhl_players_goals
2022-02-07 07:51:21.015964 (Thread-2): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_goals"
2022-02-07 07:51:21.031883 (Thread-1): SQL status: SELECT 1 in 0.05 seconds
2022-02-07 07:51:21.034940 (Thread-1): finished collecting timing info
2022-02-07 07:51:21.035248 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: ROLLBACK
2022-02-07 07:51:21.034566 (Thread-3): SQL status: BEGIN in 0.07 seconds
2022-02-07 07:51:21.036548 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_full_name".
2022-02-07 07:51:21.036701 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_full_name"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where full_name is null


2022-02-07 07:51:21.040695 (Thread-3): SQL status: SELECT 1 in 0.00 seconds
2022-02-07 07:51:21.040915 (Thread-3): finished collecting timing info
2022-02-07 07:51:21.041144 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: ROLLBACK
2022-02-07 07:51:21.041353 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: Close
2022-02-07 07:51:21.045393 (Thread-1): 07:51:21 | 1 of 7 FAIL 263 greater_than_zero_points_leaders_points.............. [FAIL 263 in 0.20s]
2022-02-07 07:51:21.045704 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: Close
2022-02-07 07:51:21.049379 (Thread-3): 07:51:21 | 3 of 7 PASS not_null_nhl_players_full_name........................... [PASS in 0.14s]
2022-02-07 07:51:21.049549 (Thread-1): Finished running node test.data_eng_challenge.greater_than_zero_points_leaders_points
2022-02-07 07:51:21.049692 (Thread-1): Began running node test.data_eng_challenge.not_null_nhl_players_id
2022-02-07 07:51:21.049892 (Thread-1): 07:51:21 | 5 of 7 START test not_null_nhl_players_id............................ [RUN]
2022-02-07 07:51:21.050333 (Thread-1): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_id".
2022-02-07 07:51:21.050418 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:51:21.050532 (Thread-1): Compiling test.data_eng_challenge.not_null_nhl_players_id
2022-02-07 07:51:21.079605 (Thread-2): finished collecting timing info
2022-02-07 07:51:21.080110 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_goals".
2022-02-07 07:51:21.080192 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_goals: BEGIN
2022-02-07 07:51:21.079941 (Thread-3): Finished running node test.data_eng_challenge.not_null_nhl_players_full_name
2022-02-07 07:51:21.085203 (Thread-3): Began running node test.data_eng_challenge.not_null_nhl_players_points
2022-02-07 07:51:21.085387 (Thread-3): 07:51:21 | 6 of 7 START test not_null_nhl_players_points........................ [RUN]
2022-02-07 07:51:21.086048 (Thread-3): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_points".
2022-02-07 07:51:21.086155 (Thread-3): Opening a new connection, currently in state closed
2022-02-07 07:51:21.086287 (Thread-3): Compiling test.data_eng_challenge.not_null_nhl_players_points
2022-02-07 07:51:21.110222 (Thread-3): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_points"
2022-02-07 07:51:21.111157 (Thread-1): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_id"
2022-02-07 07:51:21.113217 (Thread-2): SQL status: BEGIN in 0.03 seconds
2022-02-07 07:51:21.116764 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_goals".
2022-02-07 07:51:21.116844 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_goals: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_goals"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where goals is null


2022-02-07 07:51:21.124648 (Thread-2): SQL status: SELECT 1 in 0.01 seconds
2022-02-07 07:51:21.124943 (Thread-2): finished collecting timing info
2022-02-07 07:51:21.125204 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_goals: ROLLBACK
2022-02-07 07:51:21.125406 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_goals: Close
2022-02-07 07:51:21.128570 (Thread-2): 07:51:21 | 4 of 7 PASS not_null_nhl_players_goals............................... [PASS in 0.14s]
2022-02-07 07:51:21.129229 (Thread-2): Finished running node test.data_eng_challenge.not_null_nhl_players_goals
2022-02-07 07:51:21.113774 (Thread-1): finished collecting timing info
2022-02-07 07:51:21.129662 (Thread-1): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_id".
2022-02-07 07:51:21.129744 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: BEGIN
2022-02-07 07:51:21.129382 (Thread-2): Began running node test.data_eng_challenge.unique_nhl_players_id
2022-02-07 07:51:21.132273 (Thread-2): 07:51:21 | 7 of 7 START test unique_nhl_players_id.............................. [RUN]
2022-02-07 07:51:21.132673 (Thread-2): Acquiring new postgres connection "test.data_eng_challenge.unique_nhl_players_id".
2022-02-07 07:51:21.132760 (Thread-2): Opening a new connection, currently in state closed
2022-02-07 07:51:21.132844 (Thread-2): Compiling test.data_eng_challenge.unique_nhl_players_id
2022-02-07 07:51:21.152932 (Thread-2): Writing injected SQL for node "test.data_eng_challenge.unique_nhl_players_id"
2022-02-07 07:51:21.157183 (Thread-3): finished collecting timing info
2022-02-07 07:51:21.158293 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_points".
2022-02-07 07:51:21.158377 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_points: BEGIN
2022-02-07 07:51:21.158031 (Thread-1): SQL status: BEGIN in 0.03 seconds
2022-02-07 07:51:21.163177 (Thread-1): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_id".
2022-02-07 07:51:21.163300 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_id"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where id is null


2022-02-07 07:51:21.165291 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-02-07 07:51:21.165567 (Thread-1): finished collecting timing info
2022-02-07 07:51:21.165834 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: ROLLBACK
2022-02-07 07:51:21.180886 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: Close
2022-02-07 07:51:21.193982 (Thread-1): 07:51:21 | 5 of 7 PASS not_null_nhl_players_id.................................. [PASS in 0.14s]
2022-02-07 07:51:21.194184 (Thread-1): Finished running node test.data_eng_challenge.not_null_nhl_players_id
2022-02-07 07:51:21.194796 (Thread-2): finished collecting timing info
2022-02-07 07:51:21.195087 (Thread-2): Using postgres connection "test.data_eng_challenge.unique_nhl_players_id".
2022-02-07 07:51:21.195166 (Thread-2): On test.data_eng_challenge.unique_nhl_players_id: BEGIN
2022-02-07 07:51:21.197341 (Thread-3): SQL status: BEGIN in 0.04 seconds
2022-02-07 07:51:21.197449 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_points".
2022-02-07 07:51:21.197520 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_points: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_points"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where points is null


2022-02-07 07:51:21.213579 (Thread-3): SQL status: SELECT 1 in 0.02 seconds
2022-02-07 07:51:21.213980 (Thread-3): finished collecting timing info
2022-02-07 07:51:21.214280 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_points: ROLLBACK
2022-02-07 07:51:21.214454 (Thread-2): SQL status: BEGIN in 0.02 seconds
2022-02-07 07:51:21.214541 (Thread-2): Using postgres connection "test.data_eng_challenge.unique_nhl_players_id".
2022-02-07 07:51:21.214701 (Thread-2): On test.data_eng_challenge.unique_nhl_players_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.unique_nhl_players_id"} */




select count(*) as validation_errors
from (

    select
        id

    from "postgres"."public"."nhl_players"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2022-02-07 07:51:21.217924 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_points: Close
2022-02-07 07:51:21.218399 (Thread-3): 07:51:21 | 6 of 7 PASS not_null_nhl_players_points.............................. [PASS in 0.13s]
2022-02-07 07:51:21.218735 (Thread-3): Finished running node test.data_eng_challenge.not_null_nhl_players_points
2022-02-07 07:51:21.221266 (Thread-2): SQL status: SELECT 1 in 0.01 seconds
2022-02-07 07:51:21.221518 (Thread-2): finished collecting timing info
2022-02-07 07:51:21.221764 (Thread-2): On test.data_eng_challenge.unique_nhl_players_id: ROLLBACK
2022-02-07 07:51:21.221951 (Thread-2): On test.data_eng_challenge.unique_nhl_players_id: Close
2022-02-07 07:51:21.222276 (Thread-2): 07:51:21 | 7 of 7 PASS unique_nhl_players_id.................................... [PASS in 0.09s]
2022-02-07 07:51:21.222522 (Thread-2): Finished running node test.data_eng_challenge.unique_nhl_players_id
2022-02-07 07:51:21.225099 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:51:21.225205 (MainThread): Opening a new connection, currently in state closed
2022-02-07 07:51:21.225440 (MainThread): 07:51:21 | 
2022-02-07 07:51:21.230533 (MainThread): 07:51:21 | Finished running 7 tests in 0.58s.
2022-02-07 07:51:21.230800 (MainThread): Connection 'master' was properly closed.
2022-02-07 07:51:21.230884 (MainThread): Connection 'test.data_eng_challenge.not_null_nhl_players_id' was properly closed.
2022-02-07 07:51:21.230948 (MainThread): Connection 'test.data_eng_challenge.unique_nhl_players_id' was properly closed.
2022-02-07 07:51:21.231005 (MainThread): Connection 'test.data_eng_challenge.not_null_nhl_players_points' was properly closed.
2022-02-07 07:51:21.276507 (MainThread): 
2022-02-07 07:51:21.277033 (MainThread): Completed with 1 error and 0 warnings:
2022-02-07 07:51:21.277214 (MainThread): 
2022-02-07 07:51:21.277380 (MainThread): Failure in test greater_than_zero_points_leaders_points (models/mart/nhl/points_leaders.yml)
2022-02-07 07:51:21.277593 (MainThread):   Got 263 results, expected 0.
2022-02-07 07:51:21.277745 (MainThread): 
2022-02-07 07:51:21.277925 (MainThread):   compiled SQL at target/compiled/data_eng_challenge/models/mart/nhl/points_leaders.yml/schema_test/greater_than_zero_points_leaders_points.sql
2022-02-07 07:51:21.278096 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2022-02-07 07:51:21.278357 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c16dbd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c16dbd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c16dbd6d0>]}
2022-02-07 07:51:21.278584 (MainThread): Flushing usage events
2022-02-07 07:58:17.923824 (MainThread): Running with dbt=0.17.2
2022-02-07 07:58:18.060396 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-07 07:58:18.066425 (MainThread): Tracking: tracking
2022-02-07 07:58:18.067534 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fac8159d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fac7df4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fac7df430>]}
2022-02-07 07:58:18.112402 (MainThread): Partial parsing not enabled
2022-02-07 07:58:18.123258 (MainThread): Parsing macros/core.sql
2022-02-07 07:58:18.161637 (MainThread): Parsing macros/adapters/common.sql
2022-02-07 07:58:18.226327 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-07 07:58:18.227595 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-07 07:58:18.228528 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-07 07:58:18.229668 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-07 07:58:18.231655 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-07 07:58:18.234658 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-07 07:58:18.236309 (MainThread): Parsing macros/etc/query.sql
2022-02-07 07:58:18.237326 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-07 07:58:18.239196 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-07 07:58:18.240113 (MainThread): Parsing macros/etc/datetime.sql
2022-02-07 07:58:18.250292 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-07 07:58:18.258881 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-07 07:58:18.272854 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-07 07:58:18.294317 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-07 07:58:18.301348 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-07 07:58:18.303317 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-07 07:58:18.309876 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-07 07:58:18.315337 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-07 07:58:18.322335 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-07 07:58:18.362159 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-07 07:58:18.397848 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-07 07:58:18.400931 (MainThread): Parsing macros/adapters.sql
2022-02-07 07:58:18.431685 (MainThread): Parsing macros/catalog.sql
2022-02-07 07:58:18.439768 (MainThread): Parsing macros/relations.sql
2022-02-07 07:58:18.441335 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-07 07:58:18.474202 (MainThread): Partial parsing not enabled
2022-02-07 07:58:18.474739 (MainThread): Parsing macros/greater_than_zero.sql
2022-02-07 07:58:18.512617 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:58:18.512845 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:58:18.577176 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:58:18.577390 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:58:18.595867 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:58:18.596076 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:58:19.014058 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 135 macros, 0 operations, 0 seed files, 1 source
2022-02-07 07:58:19.016096 (MainThread): 
2022-02-07 07:58:19.021911 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:58:19.022210 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:58:19.034776 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-02-07 07:58:19.034961 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-07 07:58:19.053822 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-02-07 07:58:19.054088 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-02-07 07:58:19.077656 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.02 seconds
2022-02-07 07:58:19.080338 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-02-07 07:58:19.124520 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-07 07:58:19.125979 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-02-07 07:58:19.131683 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:58:19.143601 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-07 07:58:19.161059 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-02-07 07:58:19.161319 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:58:19.161426 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-07 07:58:19.164980 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2022-02-07 07:58:19.175152 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-07 07:58:19.190281 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-07 07:58:19.227894 (MainThread): Using postgres connection "master".
2022-02-07 07:58:19.241229 (MainThread): On master: BEGIN
2022-02-07 07:58:19.246360 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:58:19.246565 (MainThread): Using postgres connection "master".
2022-02-07 07:58:19.246665 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-07 07:58:19.271991 (MainThread): SQL status: SELECT 3 in 0.03 seconds
2022-02-07 07:58:19.275885 (MainThread): On master: ROLLBACK
2022-02-07 07:58:19.286247 (MainThread): Using postgres connection "master".
2022-02-07 07:58:19.286420 (MainThread): On master: BEGIN
2022-02-07 07:58:19.287161 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:58:19.287282 (MainThread): On master: COMMIT
2022-02-07 07:58:19.287358 (MainThread): Using postgres connection "master".
2022-02-07 07:58:19.287421 (MainThread): On master: COMMIT
2022-02-07 07:58:19.288722 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:58:19.288845 (MainThread): On master: Close
2022-02-07 07:58:19.299123 (MainThread): 07:58:19 | Concurrency: 3 threads (target='challenge')
2022-02-07 07:58:19.299479 (MainThread): 07:58:19 | 
2022-02-07 07:58:19.319684 (Thread-1): Began running node model.data_eng_challenge.player_game_stats
2022-02-07 07:58:19.320833 (Thread-1): 07:58:19 | 1 of 3 START view model public.player_game_stats..................... [RUN]
2022-02-07 07:58:19.324397 (Thread-1): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:58:19.324553 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:58:19.324680 (Thread-1): Compiling model.data_eng_challenge.player_game_stats
2022-02-07 07:58:19.361861 (Thread-1): Writing injected SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 07:58:19.368803 (Thread-1): finished collecting timing info
2022-02-07 07:58:19.421705 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:58:19.421957 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_tmp" cascade
2022-02-07 07:58:19.441074 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2022-02-07 07:58:19.443442 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:58:19.443549 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 07:58:19.446171 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:58:19.453227 (Thread-1): Writing runtime SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 07:58:19.457844 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:58:19.457950 (Thread-1): On model.data_eng_challenge.player_game_stats: BEGIN
2022-02-07 07:58:19.459833 (Thread-1): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:58:19.459934 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:58:19.460002 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */

  create view "postgres"."public"."player_game_stats__dbt_tmp" as (
    select
        player_person_id as nhl_player_id,
        side,
        player_person_fullName full_name,
        player_person_currentTeam_name game_team_name,
        player_stats_skaterStats_assists stats_assists,
        player_stats_skaterStats_goals stats_goals
  from "postgres"."public"."game_stats"
  );

2022-02-07 07:58:19.488839 (Thread-1): SQL status: CREATE VIEW in 0.03 seconds
2022-02-07 07:58:19.496875 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:58:19.496998 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats" rename to "player_game_stats__dbt_backup"
2022-02-07 07:58:19.498204 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:58:19.500140 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:58:19.500265 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats__dbt_tmp" rename to "player_game_stats"
2022-02-07 07:58:19.500864 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:58:19.507033 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 07:58:19.507164 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:58:19.507280 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 07:58:19.600601 (Thread-1): SQL status: COMMIT in 0.09 seconds
2022-02-07 07:58:19.604025 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:58:19.604134 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 07:58:19.648255 (Thread-1): SQL status: DROP VIEW in 0.04 seconds
2022-02-07 07:58:19.650768 (Thread-1): finished collecting timing info
2022-02-07 07:58:19.651032 (Thread-1): On model.data_eng_challenge.player_game_stats: Close
2022-02-07 07:58:19.654239 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80d4612d-1c26-42b0-aa07-0d14822b5996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa9468eb0>]}
2022-02-07 07:58:19.655353 (Thread-1): 07:58:19 | 1 of 3 OK created view model public.player_game_stats................ [CREATE VIEW in 0.33s]
2022-02-07 07:58:19.656469 (Thread-1): Finished running node model.data_eng_challenge.player_game_stats
2022-02-07 07:58:19.657035 (Thread-3): Began running node model.data_eng_challenge.nhl_players
2022-02-07 07:58:19.664658 (Thread-3): 07:58:19 | 2 of 3 START view model public.nhl_players........................... [RUN]
2022-02-07 07:58:19.665284 (Thread-3): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:58:19.665373 (Thread-3): Opening a new connection, currently in state init
2022-02-07 07:58:19.665456 (Thread-3): Compiling model.data_eng_challenge.nhl_players
2022-02-07 07:58:19.689122 (Thread-3): Writing injected SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 07:58:19.704288 (Thread-3): finished collecting timing info
2022-02-07 07:58:19.710628 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:58:19.710744 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_tmp" cascade
2022-02-07 07:58:19.723557 (Thread-3): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 07:58:19.725920 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:58:19.726053 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_backup" cascade
2022-02-07 07:58:19.727343 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:58:19.728486 (Thread-3): Writing runtime SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 07:58:19.729812 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:58:19.729936 (Thread-3): On model.data_eng_challenge.nhl_players: BEGIN
2022-02-07 07:58:19.731304 (Thread-3): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:58:19.735609 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:58:19.735734 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */

  create view "postgres"."public"."nhl_players__dbt_tmp" as (
    select
  nhl_player_id as id,
  full_name,
  game_team_name as team_name,
  sum(stats_assists) as assists,
  sum(stats_goals) as goals,
  (sum(stats_goals) + sum(stats_assists)) as points -- TODO replace this with correct columns
from "postgres"."public"."player_game_stats" --or whatever other table reference
group by id, full_name, game_team_name
  );

2022-02-07 07:58:19.751733 (Thread-3): SQL status: CREATE VIEW in 0.02 seconds
2022-02-07 07:58:19.757325 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:58:19.763598 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
alter table "postgres"."public"."nhl_players__dbt_tmp" rename to "nhl_players"
2022-02-07 07:58:19.765386 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:58:19.766677 (Thread-3): On model.data_eng_challenge.nhl_players: COMMIT
2022-02-07 07:58:19.766772 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:58:19.766867 (Thread-3): On model.data_eng_challenge.nhl_players: COMMIT
2022-02-07 07:58:19.828369 (Thread-3): SQL status: COMMIT in 0.06 seconds
2022-02-07 07:58:19.829987 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:58:19.830082 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_backup" cascade
2022-02-07 07:58:19.830917 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:58:19.833180 (Thread-3): finished collecting timing info
2022-02-07 07:58:19.833406 (Thread-3): On model.data_eng_challenge.nhl_players: Close
2022-02-07 07:58:19.846713 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80d4612d-1c26-42b0-aa07-0d14822b5996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa94233d0>]}
2022-02-07 07:58:19.848468 (Thread-3): 07:58:19 | 2 of 3 OK created view model public.nhl_players...................... [CREATE VIEW in 0.18s]
2022-02-07 07:58:19.851671 (Thread-3): Finished running node model.data_eng_challenge.nhl_players
2022-02-07 07:58:19.852274 (Thread-2): Began running node model.data_eng_challenge.points_leaders
2022-02-07 07:58:19.853554 (Thread-2): 07:58:19 | 3 of 3 START view model public.points_leaders........................ [RUN]
2022-02-07 07:58:19.856214 (Thread-2): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:58:19.856319 (Thread-2): Opening a new connection, currently in state init
2022-02-07 07:58:19.856416 (Thread-2): Compiling model.data_eng_challenge.points_leaders
2022-02-07 07:58:19.877904 (Thread-2): Writing injected SQL for node "model.data_eng_challenge.points_leaders"
2022-02-07 07:58:19.892988 (Thread-2): finished collecting timing info
2022-02-07 07:58:19.899111 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:58:19.899221 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_tmp" cascade
2022-02-07 07:58:19.928858 (Thread-2): SQL status: DROP VIEW in 0.03 seconds
2022-02-07 07:58:19.931402 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:58:19.931515 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_backup" cascade
2022-02-07 07:58:19.940772 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 07:58:19.942205 (Thread-2): Writing runtime SQL for node "model.data_eng_challenge.points_leaders"
2022-02-07 07:58:19.949500 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:58:19.949685 (Thread-2): On model.data_eng_challenge.points_leaders: BEGIN
2022-02-07 07:58:19.950458 (Thread-2): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:58:19.950562 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:58:19.950630 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */

  create view "postgres"."public"."points_leaders__dbt_tmp" as (
    select 
team_name,
full_name,
points -- TODO replace with correct projection columns
from "postgres"."public"."nhl_players"  -- or other tables
order by points desc
limit 10
  );

2022-02-07 07:58:20.000787 (Thread-2): SQL status: CREATE VIEW in 0.05 seconds
2022-02-07 07:58:20.003292 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:58:20.003397 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
alter table "postgres"."public"."points_leaders__dbt_tmp" rename to "points_leaders"
2022-02-07 07:58:20.006615 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:58:20.007733 (Thread-2): On model.data_eng_challenge.points_leaders: COMMIT
2022-02-07 07:58:20.007826 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:58:20.007895 (Thread-2): On model.data_eng_challenge.points_leaders: COMMIT
2022-02-07 07:58:20.027226 (Thread-2): SQL status: COMMIT in 0.02 seconds
2022-02-07 07:58:20.028859 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:58:20.028955 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_backup" cascade
2022-02-07 07:58:20.029722 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:58:20.034924 (Thread-2): finished collecting timing info
2022-02-07 07:58:20.035165 (Thread-2): On model.data_eng_challenge.points_leaders: Close
2022-02-07 07:58:20.042527 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80d4612d-1c26-42b0-aa07-0d14822b5996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa9e46f10>]}
2022-02-07 07:58:20.043754 (Thread-2): 07:58:20 | 3 of 3 OK created view model public.points_leaders................... [CREATE VIEW in 0.19s]
2022-02-07 07:58:20.047275 (Thread-2): Finished running node model.data_eng_challenge.points_leaders
2022-02-07 07:58:20.049756 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:58:20.049861 (MainThread): Opening a new connection, currently in state closed
2022-02-07 07:58:20.049962 (MainThread): Using postgres connection "master".
2022-02-07 07:58:20.050028 (MainThread): On master: BEGIN
2022-02-07 07:58:20.064502 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:58:20.064750 (MainThread): On master: COMMIT
2022-02-07 07:58:20.064825 (MainThread): Using postgres connection "master".
2022-02-07 07:58:20.064909 (MainThread): On master: COMMIT
2022-02-07 07:58:20.067869 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:58:20.068019 (MainThread): On master: Close
2022-02-07 07:58:20.073472 (MainThread): 07:58:20 | 
2022-02-07 07:58:20.074253 (MainThread): 07:58:20 | Finished running 3 view models in 1.05s.
2022-02-07 07:58:20.075535 (MainThread): Connection 'master' was properly closed.
2022-02-07 07:58:20.075627 (MainThread): Connection 'model.data_eng_challenge.player_game_stats' was properly closed.
2022-02-07 07:58:20.075693 (MainThread): Connection 'model.data_eng_challenge.nhl_players' was properly closed.
2022-02-07 07:58:20.075752 (MainThread): Connection 'model.data_eng_challenge.points_leaders' was properly closed.
2022-02-07 07:58:20.084182 (MainThread): 
2022-02-07 07:58:20.106174 (MainThread): Completed successfully
2022-02-07 07:58:20.106688 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-02-07 07:58:20.106984 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa9e72700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa9e869d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa94e1fd0>]}
2022-02-07 07:58:20.107211 (MainThread): Flushing usage events
2022-02-07 07:58:50.549461 (MainThread): Running with dbt=0.17.2
2022-02-07 07:58:50.659620 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-02-07 07:58:50.663137 (MainThread): Tracking: tracking
2022-02-07 07:58:50.664238 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76646eebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76646b8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76646b83d0>]}
2022-02-07 07:58:50.723318 (MainThread): Partial parsing not enabled
2022-02-07 07:58:50.724947 (MainThread): Parsing macros/core.sql
2022-02-07 07:58:50.730142 (MainThread): Parsing macros/adapters/common.sql
2022-02-07 07:58:50.795950 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-07 07:58:50.797197 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-07 07:58:50.798105 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-07 07:58:50.799213 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-07 07:58:50.801176 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-07 07:58:50.802902 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-07 07:58:50.805724 (MainThread): Parsing macros/etc/query.sql
2022-02-07 07:58:50.806890 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-07 07:58:50.808862 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-07 07:58:50.810044 (MainThread): Parsing macros/etc/datetime.sql
2022-02-07 07:58:50.821551 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-07 07:58:50.830481 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-07 07:58:50.845013 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-07 07:58:50.866544 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-07 07:58:50.874392 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-07 07:58:50.876592 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-07 07:58:50.883307 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-07 07:58:50.888092 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-07 07:58:50.895496 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-07 07:58:50.924340 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-07 07:58:50.941904 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-07 07:58:50.945927 (MainThread): Parsing macros/adapters.sql
2022-02-07 07:58:50.967679 (MainThread): Parsing macros/catalog.sql
2022-02-07 07:58:50.969861 (MainThread): Parsing macros/relations.sql
2022-02-07 07:58:50.971135 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-07 07:58:50.991850 (MainThread): Partial parsing not enabled
2022-02-07 07:58:50.992307 (MainThread): Parsing macros/greater_than_zero.sql
2022-02-07 07:58:51.033042 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:58:51.033309 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:58:51.064105 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:58:51.064311 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:58:51.076861 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:58:51.077014 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:58:51.411702 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 135 macros, 0 operations, 0 seed files, 1 source
2022-02-07 07:58:51.414019 (MainThread): 
2022-02-07 07:58:51.424521 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:58:51.424710 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:58:51.456693 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-07 07:58:51.456967 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-02-07 07:58:51.467200 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:58:51.467352 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-07 07:58:51.474274 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:58:51.474511 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:58:51.474615 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-07 07:58:51.478048 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2022-02-07 07:58:51.492252 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-07 07:58:51.495017 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-07 07:58:51.541703 (MainThread): Using postgres connection "master".
2022-02-07 07:58:51.541989 (MainThread): On master: BEGIN
2022-02-07 07:58:51.548430 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:58:51.548665 (MainThread): Using postgres connection "master".
2022-02-07 07:58:51.548769 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-07 07:58:51.555024 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2022-02-07 07:58:51.564216 (MainThread): On master: ROLLBACK
2022-02-07 07:58:51.568411 (MainThread): On master: Close
2022-02-07 07:58:51.571688 (MainThread): 07:58:51 | Concurrency: 3 threads (target='challenge')
2022-02-07 07:58:51.572049 (MainThread): 07:58:51 | 
2022-02-07 07:58:51.604291 (Thread-1): Began running node test.data_eng_challenge.greater_than_zero_points_leaders_points
2022-02-07 07:58:51.604511 (Thread-1): 07:58:51 | 1 of 7 START test greater_than_zero_points_leaders_points............ [RUN]
2022-02-07 07:58:51.606189 (Thread-2): Began running node test.data_eng_challenge.not_null_nhl_players_assists
2022-02-07 07:58:51.606336 (Thread-2): 07:58:51 | 2 of 7 START test not_null_nhl_players_assists....................... [RUN]
2022-02-07 07:58:51.606448 (Thread-3): Began running node test.data_eng_challenge.not_null_nhl_players_full_name
2022-02-07 07:58:51.606553 (Thread-3): 07:58:51 | 3 of 7 START test not_null_nhl_players_full_name..................... [RUN]
2022-02-07 07:58:51.606856 (Thread-1): Acquiring new postgres connection "test.data_eng_challenge.greater_than_zero_points_leaders_points".
2022-02-07 07:58:51.606936 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:58:51.607026 (Thread-1): Compiling test.data_eng_challenge.greater_than_zero_points_leaders_points
2022-02-07 07:58:51.647799 (Thread-1): Writing injected SQL for node "test.data_eng_challenge.greater_than_zero_points_leaders_points"
2022-02-07 07:58:51.649058 (Thread-2): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_assists".
2022-02-07 07:58:51.650028 (Thread-2): Opening a new connection, currently in state init
2022-02-07 07:58:51.650141 (Thread-2): Compiling test.data_eng_challenge.not_null_nhl_players_assists
2022-02-07 07:58:51.649771 (Thread-3): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_full_name".
2022-02-07 07:58:51.676514 (Thread-3): Opening a new connection, currently in state init
2022-02-07 07:58:51.676650 (Thread-3): Compiling test.data_eng_challenge.not_null_nhl_players_full_name
2022-02-07 07:58:51.684590 (Thread-3): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_full_name"
2022-02-07 07:58:51.685077 (Thread-3): finished collecting timing info
2022-02-07 07:58:51.685337 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_full_name".
2022-02-07 07:58:51.685416 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: BEGIN
2022-02-07 07:58:51.676151 (Thread-1): finished collecting timing info
2022-02-07 07:58:51.699004 (Thread-1): Using postgres connection "test.data_eng_challenge.greater_than_zero_points_leaders_points".
2022-02-07 07:58:51.699147 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: BEGIN
2022-02-07 07:58:51.705118 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:58:51.705286 (Thread-1): Using postgres connection "test.data_eng_challenge.greater_than_zero_points_leaders_points".
2022-02-07 07:58:51.705363 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.greater_than_zero_points_leaders_points"} */




select count(*)
from (
    select
      points    

    from "postgres"."public"."points_leaders"

    where points <= 0

) validation_errors


2022-02-07 07:58:51.662906 (Thread-2): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_assists"
2022-02-07 07:58:51.722162 (Thread-2): finished collecting timing info
2022-02-07 07:58:51.722585 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_assists".
2022-02-07 07:58:51.722671 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: BEGIN
2022-02-07 07:58:51.729192 (Thread-3): SQL status: BEGIN in 0.04 seconds
2022-02-07 07:58:51.729329 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_full_name".
2022-02-07 07:58:51.729404 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_full_name"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where full_name is null


2022-02-07 07:58:51.733585 (Thread-3): SQL status: SELECT 1 in 0.00 seconds
2022-02-07 07:58:51.733898 (Thread-3): finished collecting timing info
2022-02-07 07:58:51.734168 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: ROLLBACK
2022-02-07 07:58:51.736378 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: Close
2022-02-07 07:58:51.736862 (Thread-3): 07:58:51 | 3 of 7 PASS not_null_nhl_players_full_name........................... [PASS in 0.09s]
2022-02-07 07:58:51.737196 (Thread-3): Finished running node test.data_eng_challenge.not_null_nhl_players_full_name
2022-02-07 07:58:51.737341 (Thread-3): Began running node test.data_eng_challenge.not_null_nhl_players_goals
2022-02-07 07:58:51.737553 (Thread-3): 07:58:51 | 4 of 7 START test not_null_nhl_players_goals......................... [RUN]
2022-02-07 07:58:51.739005 (Thread-3): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_goals".
2022-02-07 07:58:51.739096 (Thread-3): Opening a new connection, currently in state closed
2022-02-07 07:58:51.739195 (Thread-3): Compiling test.data_eng_challenge.not_null_nhl_players_goals
2022-02-07 07:58:51.747108 (Thread-3): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_goals"
2022-02-07 07:58:51.747579 (Thread-3): finished collecting timing info
2022-02-07 07:58:51.747828 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_goals".
2022-02-07 07:58:51.747906 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_goals: BEGIN
2022-02-07 07:58:51.773202 (Thread-1): SQL status: SELECT 1 in 0.07 seconds
2022-02-07 07:58:51.773562 (Thread-1): finished collecting timing info
2022-02-07 07:58:51.773842 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: ROLLBACK
2022-02-07 07:58:51.777895 (Thread-2): SQL status: BEGIN in 0.06 seconds
2022-02-07 07:58:51.778087 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_assists".
2022-02-07 07:58:51.778189 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_assists"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where assists is null


2022-02-07 07:58:51.788337 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: Close
2022-02-07 07:58:51.789056 (Thread-1): 07:58:51 | 1 of 7 PASS greater_than_zero_points_leaders_points.................. [PASS in 0.18s]
2022-02-07 07:58:51.790578 (Thread-1): Finished running node test.data_eng_challenge.greater_than_zero_points_leaders_points
2022-02-07 07:58:51.790760 (Thread-1): Began running node test.data_eng_challenge.not_null_nhl_players_id
2022-02-07 07:58:51.790969 (Thread-1): 07:58:51 | 5 of 7 START test not_null_nhl_players_id............................ [RUN]
2022-02-07 07:58:51.798709 (Thread-1): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_id".
2022-02-07 07:58:51.798834 (Thread-2): SQL status: SELECT 1 in 0.02 seconds
2022-02-07 07:58:51.799168 (Thread-2): finished collecting timing info
2022-02-07 07:58:51.799457 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: ROLLBACK
2022-02-07 07:58:51.798943 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:58:51.804160 (Thread-1): Compiling test.data_eng_challenge.not_null_nhl_players_id
2022-02-07 07:58:51.823409 (Thread-1): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_id"
2022-02-07 07:58:51.824727 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: Close
2022-02-07 07:58:51.830722 (Thread-2): 07:58:51 | 2 of 7 PASS not_null_nhl_players_assists............................. [PASS in 0.18s]
2022-02-07 07:58:51.825464 (Thread-3): SQL status: BEGIN in 0.08 seconds
2022-02-07 07:58:51.831035 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_goals".
2022-02-07 07:58:51.831114 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_goals: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_goals"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where goals is null


2022-02-07 07:58:51.836230 (Thread-3): SQL status: SELECT 1 in 0.00 seconds
2022-02-07 07:58:51.836549 (Thread-3): finished collecting timing info
2022-02-07 07:58:51.836857 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_goals: ROLLBACK
2022-02-07 07:58:51.838757 (Thread-2): Finished running node test.data_eng_challenge.not_null_nhl_players_assists
2022-02-07 07:58:51.838902 (Thread-2): Began running node test.data_eng_challenge.not_null_nhl_players_points
2022-02-07 07:58:51.839025 (Thread-2): 07:58:51 | 6 of 7 START test not_null_nhl_players_points........................ [RUN]
2022-02-07 07:58:51.839570 (Thread-2): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_points".
2022-02-07 07:58:51.839687 (Thread-2): Opening a new connection, currently in state closed
2022-02-07 07:58:51.839780 (Thread-2): Compiling test.data_eng_challenge.not_null_nhl_players_points
2022-02-07 07:58:51.861370 (Thread-2): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_points"
2022-02-07 07:58:51.861631 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_goals: Close
2022-02-07 07:58:51.879541 (Thread-3): 07:58:51 | 4 of 7 PASS not_null_nhl_players_goals............................... [PASS in 0.14s]
2022-02-07 07:58:51.862050 (Thread-1): finished collecting timing info
2022-02-07 07:58:51.879995 (Thread-1): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_id".
2022-02-07 07:58:51.880084 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: BEGIN
2022-02-07 07:58:51.881480 (Thread-3): Finished running node test.data_eng_challenge.not_null_nhl_players_goals
2022-02-07 07:58:51.881620 (Thread-3): Began running node test.data_eng_challenge.unique_nhl_players_id
2022-02-07 07:58:51.881734 (Thread-3): 07:58:51 | 7 of 7 START test unique_nhl_players_id.............................. [RUN]
2022-02-07 07:58:51.888287 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:58:51.888451 (Thread-1): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_id".
2022-02-07 07:58:51.888527 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_id"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where id is null


2022-02-07 07:58:51.907393 (Thread-3): Acquiring new postgres connection "test.data_eng_challenge.unique_nhl_players_id".
2022-02-07 07:58:51.907583 (Thread-3): Opening a new connection, currently in state closed
2022-02-07 07:58:51.907684 (Thread-3): Compiling test.data_eng_challenge.unique_nhl_players_id
2022-02-07 07:58:51.915803 (Thread-3): Writing injected SQL for node "test.data_eng_challenge.unique_nhl_players_id"
2022-02-07 07:58:51.916323 (Thread-3): finished collecting timing info
2022-02-07 07:58:51.918117 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2022-02-07 07:58:51.919389 (Thread-1): finished collecting timing info
2022-02-07 07:58:51.919591 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: ROLLBACK
2022-02-07 07:58:51.919984 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: Close
2022-02-07 07:58:51.922002 (Thread-1): 07:58:51 | 5 of 7 PASS not_null_nhl_players_id.................................. [PASS in 0.13s]
2022-02-07 07:58:51.918406 (Thread-2): finished collecting timing info
2022-02-07 07:58:51.922389 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_points".
2022-02-07 07:58:51.922474 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_points: BEGIN
2022-02-07 07:58:51.923504 (Thread-1): Finished running node test.data_eng_challenge.not_null_nhl_players_id
2022-02-07 07:58:51.937959 (Thread-2): SQL status: BEGIN in 0.02 seconds
2022-02-07 07:58:51.938171 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_points".
2022-02-07 07:58:51.938257 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_points: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_points"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where points is null


2022-02-07 07:58:51.919163 (Thread-3): Using postgres connection "test.data_eng_challenge.unique_nhl_players_id".
2022-02-07 07:58:51.940320 (Thread-3): On test.data_eng_challenge.unique_nhl_players_id: BEGIN
2022-02-07 07:58:51.942054 (Thread-2): SQL status: SELECT 1 in 0.00 seconds
2022-02-07 07:58:51.942323 (Thread-2): finished collecting timing info
2022-02-07 07:58:51.942651 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_points: ROLLBACK
2022-02-07 07:58:51.942856 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_points: Close
2022-02-07 07:58:51.943303 (Thread-2): 07:58:51 | 6 of 7 PASS not_null_nhl_players_points.............................. [PASS in 0.10s]
2022-02-07 07:58:51.943602 (Thread-2): Finished running node test.data_eng_challenge.not_null_nhl_players_points
2022-02-07 07:58:51.948730 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:58:51.948853 (Thread-3): Using postgres connection "test.data_eng_challenge.unique_nhl_players_id".
2022-02-07 07:58:51.948927 (Thread-3): On test.data_eng_challenge.unique_nhl_players_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.unique_nhl_players_id"} */




select count(*) as validation_errors
from (

    select
        id

    from "postgres"."public"."nhl_players"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2022-02-07 07:58:51.958689 (Thread-3): SQL status: SELECT 1 in 0.01 seconds
2022-02-07 07:58:51.959001 (Thread-3): finished collecting timing info
2022-02-07 07:58:51.959305 (Thread-3): On test.data_eng_challenge.unique_nhl_players_id: ROLLBACK
2022-02-07 07:58:51.959516 (Thread-3): On test.data_eng_challenge.unique_nhl_players_id: Close
2022-02-07 07:58:51.959933 (Thread-3): 07:58:51 | 7 of 7 PASS unique_nhl_players_id.................................... [PASS in 0.05s]
2022-02-07 07:58:51.960286 (Thread-3): Finished running node test.data_eng_challenge.unique_nhl_players_id
2022-02-07 07:58:51.961419 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:58:51.961518 (MainThread): Opening a new connection, currently in state closed
2022-02-07 07:58:51.961750 (MainThread): 07:58:51 | 
2022-02-07 07:58:51.961954 (MainThread): 07:58:51 | Finished running 7 tests in 0.54s.
2022-02-07 07:58:51.962112 (MainThread): Connection 'master' was properly closed.
2022-02-07 07:58:51.962186 (MainThread): Connection 'test.data_eng_challenge.not_null_nhl_players_id' was properly closed.
2022-02-07 07:58:51.962276 (MainThread): Connection 'test.data_eng_challenge.not_null_nhl_players_points' was properly closed.
2022-02-07 07:58:51.962334 (MainThread): Connection 'test.data_eng_challenge.unique_nhl_players_id' was properly closed.
2022-02-07 07:58:52.007199 (MainThread): 
2022-02-07 07:58:52.009534 (MainThread): Completed successfully
2022-02-07 07:58:52.009769 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2022-02-07 07:58:52.010019 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76613b2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76613b2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76613b2580>]}
2022-02-07 07:58:52.010227 (MainThread): Flushing usage events
2022-02-07 07:59:33.570654 (MainThread): Running with dbt=0.17.2
2022-02-07 07:59:33.694434 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-07 07:59:33.709467 (MainThread): Tracking: tracking
2022-02-07 07:59:33.710614 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3f7a13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3f76d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3f76d370>]}
2022-02-07 07:59:33.737597 (MainThread): Partial parsing not enabled
2022-02-07 07:59:33.738993 (MainThread): Parsing macros/core.sql
2022-02-07 07:59:33.746962 (MainThread): Parsing macros/adapters/common.sql
2022-02-07 07:59:33.801898 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-07 07:59:33.809449 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-07 07:59:33.810548 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-07 07:59:33.811660 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-07 07:59:33.814992 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-07 07:59:33.817234 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-07 07:59:33.819226 (MainThread): Parsing macros/etc/query.sql
2022-02-07 07:59:33.820449 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-07 07:59:33.822548 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-07 07:59:33.823513 (MainThread): Parsing macros/etc/datetime.sql
2022-02-07 07:59:33.833310 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-07 07:59:33.844192 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-07 07:59:33.858180 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-07 07:59:33.882654 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-07 07:59:33.892960 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-07 07:59:33.894782 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-07 07:59:33.901311 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-07 07:59:33.907472 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-07 07:59:33.940146 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-07 07:59:34.055112 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-07 07:59:34.074174 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-07 07:59:34.082649 (MainThread): Parsing macros/adapters.sql
2022-02-07 07:59:34.110226 (MainThread): Parsing macros/catalog.sql
2022-02-07 07:59:34.112629 (MainThread): Parsing macros/relations.sql
2022-02-07 07:59:34.114007 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-07 07:59:34.137525 (MainThread): Partial parsing not enabled
2022-02-07 07:59:34.138383 (MainThread): Parsing macros/greater_than_zero.sql
2022-02-07 07:59:34.177744 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:59:34.177945 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:59:34.224271 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:59:34.224494 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:59:34.241652 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:59:34.241874 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:59:34.649121 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 135 macros, 0 operations, 0 seed files, 1 source
2022-02-07 07:59:34.652358 (MainThread): 
2022-02-07 07:59:34.656143 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:59:34.656272 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:59:34.664623 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-02-07 07:59:34.664840 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-07 07:59:34.687043 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-02-07 07:59:34.687289 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-02-07 07:59:34.705381 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.02 seconds
2022-02-07 07:59:34.707993 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-02-07 07:59:34.723612 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-07 07:59:34.723876 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-02-07 07:59:34.730666 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:59:34.730799 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-07 07:59:34.734337 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:59:34.734560 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:59:34.734665 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-07 07:59:34.739893 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.01 seconds
2022-02-07 07:59:34.743643 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-07 07:59:34.743913 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-07 07:59:34.764717 (MainThread): Using postgres connection "master".
2022-02-07 07:59:34.764942 (MainThread): On master: BEGIN
2022-02-07 07:59:34.776006 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:59:34.776239 (MainThread): Using postgres connection "master".
2022-02-07 07:59:34.776343 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-07 07:59:34.782197 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2022-02-07 07:59:34.785967 (MainThread): On master: ROLLBACK
2022-02-07 07:59:34.786230 (MainThread): Using postgres connection "master".
2022-02-07 07:59:34.786364 (MainThread): On master: BEGIN
2022-02-07 07:59:34.786842 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:59:34.786965 (MainThread): On master: COMMIT
2022-02-07 07:59:34.787064 (MainThread): Using postgres connection "master".
2022-02-07 07:59:34.787152 (MainThread): On master: COMMIT
2022-02-07 07:59:34.787369 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:59:34.787493 (MainThread): On master: Close
2022-02-07 07:59:34.787876 (MainThread): 07:59:34 | Concurrency: 3 threads (target='challenge')
2022-02-07 07:59:34.790439 (MainThread): 07:59:34 | 
2022-02-07 07:59:34.826210 (Thread-1): Began running node model.data_eng_challenge.player_game_stats
2022-02-07 07:59:34.827331 (Thread-1): 07:59:34 | 1 of 3 START view model public.player_game_stats..................... [RUN]
2022-02-07 07:59:34.832285 (Thread-1): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:59:34.832418 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:59:34.832517 (Thread-1): Compiling model.data_eng_challenge.player_game_stats
2022-02-07 07:59:34.883460 (Thread-1): Writing injected SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 07:59:34.884042 (Thread-1): finished collecting timing info
2022-02-07 07:59:34.953588 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:59:34.954778 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_tmp" cascade
2022-02-07 07:59:34.959095 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:59:34.961320 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:59:34.961446 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 07:59:34.961850 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:59:34.968029 (Thread-1): Writing runtime SQL for node "model.data_eng_challenge.player_game_stats"
2022-02-07 07:59:34.968608 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:59:34.968732 (Thread-1): On model.data_eng_challenge.player_game_stats: BEGIN
2022-02-07 07:59:34.969222 (Thread-1): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:59:34.969364 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:59:34.969460 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */

  create view "postgres"."public"."player_game_stats__dbt_tmp" as (
    select
        player_person_id as nhl_player_id,
        side,
        player_person_fullName full_name,
        player_person_currentTeam_name game_team_name,
        player_stats_skaterStats_assists stats_assists,
        player_stats_skaterStats_goals stats_goals
  from "postgres"."public"."game_stats"
  );

2022-02-07 07:59:34.972099 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2022-02-07 07:59:34.980932 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:59:34.981099 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats" rename to "player_game_stats__dbt_backup"
2022-02-07 07:59:34.981695 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:59:34.983748 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:59:34.983877 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
alter table "postgres"."public"."player_game_stats__dbt_tmp" rename to "player_game_stats"
2022-02-07 07:59:34.984406 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:59:34.994554 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 07:59:34.994766 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:59:34.994869 (Thread-1): On model.data_eng_challenge.player_game_stats: COMMIT
2022-02-07 07:59:35.032839 (Thread-1): SQL status: COMMIT in 0.04 seconds
2022-02-07 07:59:35.036772 (Thread-1): Using postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:59:35.036884 (Thread-1): On model.data_eng_challenge.player_game_stats: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.player_game_stats"} */
drop view if exists "postgres"."public"."player_game_stats__dbt_backup" cascade
2022-02-07 07:59:35.049666 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 07:59:35.056781 (Thread-1): finished collecting timing info
2022-02-07 07:59:35.057012 (Thread-1): On model.data_eng_challenge.player_game_stats: Close
2022-02-07 07:59:35.063365 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd6a71f-05cb-4ad9-8f6a-10c8b9dacb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3c3f2f70>]}
2022-02-07 07:59:35.064474 (Thread-1): 07:59:35 | 1 of 3 OK created view model public.player_game_stats................ [CREATE VIEW in 0.23s]
2022-02-07 07:59:35.067569 (Thread-1): Finished running node model.data_eng_challenge.player_game_stats
2022-02-07 07:59:35.068107 (Thread-3): Began running node model.data_eng_challenge.nhl_players
2022-02-07 07:59:35.068993 (Thread-3): 07:59:35 | 2 of 3 START view model public.nhl_players........................... [RUN]
2022-02-07 07:59:35.071038 (Thread-3): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:59:35.071135 (Thread-3): Opening a new connection, currently in state init
2022-02-07 07:59:35.071236 (Thread-3): Compiling model.data_eng_challenge.nhl_players
2022-02-07 07:59:35.107949 (Thread-3): Writing injected SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 07:59:35.108546 (Thread-3): finished collecting timing info
2022-02-07 07:59:35.114823 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:59:35.114931 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_tmp" cascade
2022-02-07 07:59:35.138774 (Thread-3): SQL status: DROP VIEW in 0.02 seconds
2022-02-07 07:59:35.141189 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:59:35.141288 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_backup" cascade
2022-02-07 07:59:35.145075 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:59:35.146207 (Thread-3): Writing runtime SQL for node "model.data_eng_challenge.nhl_players"
2022-02-07 07:59:35.146662 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:59:35.146748 (Thread-3): On model.data_eng_challenge.nhl_players: BEGIN
2022-02-07 07:59:35.148977 (Thread-3): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:59:35.149072 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:59:35.149140 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */

  create view "postgres"."public"."nhl_players__dbt_tmp" as (
    select
  nhl_player_id as id,
  full_name,
  game_team_name as team_name,
  sum(stats_assists) as assists,
  sum(stats_goals) as goals,
  (sum(stats_goals) + sum(stats_assists)) as points -- TODO replace this with correct columns
from "postgres"."public"."player_game_stats" --or whatever other table reference
group by id, full_name, game_team_name
  );

2022-02-07 07:59:35.156523 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-02-07 07:59:35.158917 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:59:35.159016 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
alter table "postgres"."public"."nhl_players__dbt_tmp" rename to "nhl_players"
2022-02-07 07:59:35.163476 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-02-07 07:59:35.164619 (Thread-3): On model.data_eng_challenge.nhl_players: COMMIT
2022-02-07 07:59:35.164713 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:59:35.164780 (Thread-3): On model.data_eng_challenge.nhl_players: COMMIT
2022-02-07 07:59:35.207895 (Thread-3): SQL status: COMMIT in 0.04 seconds
2022-02-07 07:59:35.209587 (Thread-3): Using postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:59:35.209690 (Thread-3): On model.data_eng_challenge.nhl_players: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.nhl_players"} */
drop view if exists "postgres"."public"."nhl_players__dbt_backup" cascade
2022-02-07 07:59:35.217916 (Thread-3): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 07:59:35.220556 (Thread-3): finished collecting timing info
2022-02-07 07:59:35.220828 (Thread-3): On model.data_eng_challenge.nhl_players: Close
2022-02-07 07:59:35.225819 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd6a71f-05cb-4ad9-8f6a-10c8b9dacb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3c3b1460>]}
2022-02-07 07:59:35.228922 (Thread-3): 07:59:35 | 2 of 3 OK created view model public.nhl_players...................... [CREATE VIEW in 0.15s]
2022-02-07 07:59:35.229974 (Thread-3): Finished running node model.data_eng_challenge.nhl_players
2022-02-07 07:59:35.230542 (Thread-2): Began running node model.data_eng_challenge.points_leaders
2022-02-07 07:59:35.231783 (Thread-2): 07:59:35 | 3 of 3 START view model public.points_leaders........................ [RUN]
2022-02-07 07:59:35.233033 (Thread-2): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:59:35.233179 (Thread-2): Opening a new connection, currently in state init
2022-02-07 07:59:35.233356 (Thread-2): Compiling model.data_eng_challenge.points_leaders
2022-02-07 07:59:35.241576 (Thread-2): Writing injected SQL for node "model.data_eng_challenge.points_leaders"
2022-02-07 07:59:35.242069 (Thread-2): finished collecting timing info
2022-02-07 07:59:35.255490 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:59:35.255692 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_tmp" cascade
2022-02-07 07:59:35.263377 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2022-02-07 07:59:35.265525 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:59:35.265619 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_backup" cascade
2022-02-07 07:59:35.269154 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:59:35.270244 (Thread-2): Writing runtime SQL for node "model.data_eng_challenge.points_leaders"
2022-02-07 07:59:35.270648 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:59:35.270733 (Thread-2): On model.data_eng_challenge.points_leaders: BEGIN
2022-02-07 07:59:35.272802 (Thread-2): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:59:35.272920 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:59:35.272995 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */

  create view "postgres"."public"."points_leaders__dbt_tmp" as (
    select 
team_name,
full_name,
points -- TODO replace with correct projection columns
from "postgres"."public"."nhl_players"  -- or other tables
order by points desc
limit 10
  );

2022-02-07 07:59:35.279609 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2022-02-07 07:59:35.283469 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:59:35.283583 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
alter table "postgres"."public"."points_leaders__dbt_tmp" rename to "points_leaders"
2022-02-07 07:59:35.298099 (Thread-2): SQL status: ALTER TABLE in 0.01 seconds
2022-02-07 07:59:35.299355 (Thread-2): On model.data_eng_challenge.points_leaders: COMMIT
2022-02-07 07:59:35.299454 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:59:35.299609 (Thread-2): On model.data_eng_challenge.points_leaders: COMMIT
2022-02-07 07:59:35.337151 (Thread-2): SQL status: COMMIT in 0.04 seconds
2022-02-07 07:59:35.338840 (Thread-2): Using postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:59:35.338934 (Thread-2): On model.data_eng_challenge.points_leaders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "model.data_eng_challenge.points_leaders"} */
drop view if exists "postgres"."public"."points_leaders__dbt_backup" cascade
2022-02-07 07:59:35.339498 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-02-07 07:59:35.342374 (Thread-2): finished collecting timing info
2022-02-07 07:59:35.342627 (Thread-2): On model.data_eng_challenge.points_leaders: Close
2022-02-07 07:59:35.344544 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd6a71f-05cb-4ad9-8f6a-10c8b9dacb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3cdd2e20>]}
2022-02-07 07:59:35.345622 (Thread-2): 07:59:35 | 3 of 3 OK created view model public.points_leaders................... [CREATE VIEW in 0.11s]
2022-02-07 07:59:35.346855 (Thread-2): Finished running node model.data_eng_challenge.points_leaders
2022-02-07 07:59:35.347987 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:59:35.348114 (MainThread): Opening a new connection, currently in state closed
2022-02-07 07:59:35.348241 (MainThread): Using postgres connection "master".
2022-02-07 07:59:35.348345 (MainThread): On master: BEGIN
2022-02-07 07:59:35.358609 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:59:35.358795 (MainThread): On master: COMMIT
2022-02-07 07:59:35.358872 (MainThread): Using postgres connection "master".
2022-02-07 07:59:35.358942 (MainThread): On master: COMMIT
2022-02-07 07:59:35.359157 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-07 07:59:35.359268 (MainThread): On master: Close
2022-02-07 07:59:35.364339 (MainThread): 07:59:35 | 
2022-02-07 07:59:35.365852 (MainThread): 07:59:35 | Finished running 3 view models in 0.71s.
2022-02-07 07:59:35.366118 (MainThread): Connection 'master' was properly closed.
2022-02-07 07:59:35.366202 (MainThread): Connection 'model.data_eng_challenge.player_game_stats' was properly closed.
2022-02-07 07:59:35.366266 (MainThread): Connection 'model.data_eng_challenge.nhl_players' was properly closed.
2022-02-07 07:59:35.366326 (MainThread): Connection 'model.data_eng_challenge.points_leaders' was properly closed.
2022-02-07 07:59:35.387548 (MainThread): 
2022-02-07 07:59:35.387953 (MainThread): Completed successfully
2022-02-07 07:59:35.388148 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-02-07 07:59:35.388425 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3cede460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3c46ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3ce2cf70>]}
2022-02-07 07:59:35.388633 (MainThread): Flushing usage events
2022-02-07 07:59:37.384411 (MainThread): Running with dbt=0.17.2
2022-02-07 07:59:37.606964 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-02-07 07:59:37.610220 (MainThread): Tracking: tracking
2022-02-07 07:59:37.612442 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4134033d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4133d0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4133d03a0>]}
2022-02-07 07:59:37.702456 (MainThread): Partial parsing not enabled
2022-02-07 07:59:37.716614 (MainThread): Parsing macros/core.sql
2022-02-07 07:59:37.724675 (MainThread): Parsing macros/adapters/common.sql
2022-02-07 07:59:37.838642 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-07 07:59:37.845448 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-07 07:59:37.846867 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-07 07:59:37.848084 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-07 07:59:37.851233 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-07 07:59:37.853074 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-07 07:59:37.854896 (MainThread): Parsing macros/etc/query.sql
2022-02-07 07:59:37.856072 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-07 07:59:37.858353 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-07 07:59:37.859402 (MainThread): Parsing macros/etc/datetime.sql
2022-02-07 07:59:37.872260 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-07 07:59:37.880547 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-07 07:59:37.896785 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-07 07:59:37.919275 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-07 07:59:37.926355 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-07 07:59:37.928189 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-07 07:59:37.934236 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-07 07:59:37.939705 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-07 07:59:37.946746 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-07 07:59:37.978529 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-07 07:59:37.996927 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-07 07:59:37.999476 (MainThread): Parsing macros/adapters.sql
2022-02-07 07:59:38.022560 (MainThread): Parsing macros/catalog.sql
2022-02-07 07:59:38.025014 (MainThread): Parsing macros/relations.sql
2022-02-07 07:59:38.026402 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-07 07:59:38.051813 (MainThread): Partial parsing not enabled
2022-02-07 07:59:38.052681 (MainThread): Parsing macros/greater_than_zero.sql
2022-02-07 07:59:38.087159 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.points_leaders".
2022-02-07 07:59:38.087396 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:59:38.116388 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.nhl_players".
2022-02-07 07:59:38.116577 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:59:38.128924 (MainThread): Acquiring new postgres connection "model.data_eng_challenge.player_game_stats".
2022-02-07 07:59:38.129106 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:59:38.441902 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 135 macros, 0 operations, 0 seed files, 1 source
2022-02-07 07:59:38.444070 (MainThread): 
2022-02-07 07:59:38.450107 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:59:38.450259 (MainThread): Opening a new connection, currently in state init
2022-02-07 07:59:38.475399 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-07 07:59:38.475645 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-02-07 07:59:38.495903 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:59:38.496147 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-07 07:59:38.504054 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:59:38.504269 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-07 07:59:38.504372 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-07 07:59:38.507700 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2022-02-07 07:59:38.526432 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-07 07:59:38.529501 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-07 07:59:38.574100 (MainThread): Using postgres connection "master".
2022-02-07 07:59:38.574519 (MainThread): On master: BEGIN
2022-02-07 07:59:38.578839 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-02-07 07:59:38.578999 (MainThread): Using postgres connection "master".
2022-02-07 07:59:38.579097 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-07 07:59:38.594223 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2022-02-07 07:59:38.598105 (MainThread): On master: ROLLBACK
2022-02-07 07:59:38.603663 (MainThread): On master: Close
2022-02-07 07:59:38.605508 (MainThread): 07:59:38 | Concurrency: 3 threads (target='challenge')
2022-02-07 07:59:38.607281 (MainThread): 07:59:38 | 
2022-02-07 07:59:38.641158 (Thread-1): Began running node test.data_eng_challenge.greater_than_zero_points_leaders_points
2022-02-07 07:59:38.641588 (Thread-1): 07:59:38 | 1 of 7 START test greater_than_zero_points_leaders_points............ [RUN]
2022-02-07 07:59:38.641480 (Thread-3): Began running node test.data_eng_challenge.not_null_nhl_players_full_name
2022-02-07 07:59:38.642789 (Thread-3): 07:59:38 | 3 of 7 START test not_null_nhl_players_full_name..................... [RUN]
2022-02-07 07:59:38.641385 (Thread-2): Began running node test.data_eng_challenge.not_null_nhl_players_assists
2022-02-07 07:59:38.642964 (Thread-2): 07:59:38 | 2 of 7 START test not_null_nhl_players_assists....................... [RUN]
2022-02-07 07:59:38.643306 (Thread-1): Acquiring new postgres connection "test.data_eng_challenge.greater_than_zero_points_leaders_points".
2022-02-07 07:59:38.644896 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:59:38.645134 (Thread-1): Compiling test.data_eng_challenge.greater_than_zero_points_leaders_points
2022-02-07 07:59:38.644174 (Thread-3): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_full_name".
2022-02-07 07:59:38.687515 (Thread-3): Opening a new connection, currently in state init
2022-02-07 07:59:38.687673 (Thread-3): Compiling test.data_eng_challenge.not_null_nhl_players_full_name
2022-02-07 07:59:38.695881 (Thread-3): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_full_name"
2022-02-07 07:59:38.644822 (Thread-2): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_assists".
2022-02-07 07:59:38.706388 (Thread-2): Opening a new connection, currently in state init
2022-02-07 07:59:38.706528 (Thread-2): Compiling test.data_eng_challenge.not_null_nhl_players_assists
2022-02-07 07:59:38.676362 (Thread-1): Writing injected SQL for node "test.data_eng_challenge.greater_than_zero_points_leaders_points"
2022-02-07 07:59:38.696341 (Thread-3): finished collecting timing info
2022-02-07 07:59:38.726251 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_full_name".
2022-02-07 07:59:38.726361 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: BEGIN
2022-02-07 07:59:38.732075 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-02-07 07:59:38.732267 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_full_name".
2022-02-07 07:59:38.732375 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_full_name"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where full_name is null


2022-02-07 07:59:38.725933 (Thread-1): finished collecting timing info
2022-02-07 07:59:38.734814 (Thread-1): Using postgres connection "test.data_eng_challenge.greater_than_zero_points_leaders_points".
2022-02-07 07:59:38.735041 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: BEGIN
2022-02-07 07:59:38.734965 (Thread-3): SQL status: SELECT 1 in 0.00 seconds
2022-02-07 07:59:38.736120 (Thread-3): finished collecting timing info
2022-02-07 07:59:38.737079 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: ROLLBACK
2022-02-07 07:59:38.724836 (Thread-2): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_assists"
2022-02-07 07:59:38.738510 (Thread-2): finished collecting timing info
2022-02-07 07:59:38.739888 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_full_name: Close
2022-02-07 07:59:38.740526 (Thread-3): 07:59:38 | 3 of 7 PASS not_null_nhl_players_full_name........................... [PASS in 0.10s]
2022-02-07 07:59:38.745392 (Thread-3): Finished running node test.data_eng_challenge.not_null_nhl_players_full_name
2022-02-07 07:59:38.745651 (Thread-3): Began running node test.data_eng_challenge.not_null_nhl_players_goals
2022-02-07 07:59:38.746023 (Thread-3): 07:59:38 | 4 of 7 START test not_null_nhl_players_goals......................... [RUN]
2022-02-07 07:59:38.749872 (Thread-3): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_goals".
2022-02-07 07:59:38.749973 (Thread-3): Opening a new connection, currently in state closed
2022-02-07 07:59:38.750065 (Thread-3): Compiling test.data_eng_challenge.not_null_nhl_players_goals
2022-02-07 07:59:38.740012 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_assists".
2022-02-07 07:59:38.769369 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: BEGIN
2022-02-07 07:59:38.769169 (Thread-1): SQL status: BEGIN in 0.03 seconds
2022-02-07 07:59:38.773727 (Thread-1): Using postgres connection "test.data_eng_challenge.greater_than_zero_points_leaders_points".
2022-02-07 07:59:38.773830 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.greater_than_zero_points_leaders_points"} */




select count(*)
from (
    select
      points    

    from "postgres"."public"."points_leaders"

    where points <= 0

) validation_errors


2022-02-07 07:59:38.799275 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2022-02-07 07:59:38.799845 (Thread-1): finished collecting timing info
2022-02-07 07:59:38.800254 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: ROLLBACK
2022-02-07 07:59:38.804387 (Thread-2): SQL status: BEGIN in 0.03 seconds
2022-02-07 07:59:38.804539 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_assists".
2022-02-07 07:59:38.804631 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_assists"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where assists is null


2022-02-07 07:59:38.806782 (Thread-1): On test.data_eng_challenge.greater_than_zero_points_leaders_points: Close
2022-02-07 07:59:38.808556 (Thread-1): 07:59:38 | 1 of 7 PASS greater_than_zero_points_leaders_points.................. [PASS in 0.17s]
2022-02-07 07:59:38.808889 (Thread-1): Finished running node test.data_eng_challenge.greater_than_zero_points_leaders_points
2022-02-07 07:59:38.809043 (Thread-1): Began running node test.data_eng_challenge.not_null_nhl_players_id
2022-02-07 07:59:38.809252 (Thread-1): 07:59:38 | 5 of 7 START test not_null_nhl_players_id............................ [RUN]
2022-02-07 07:59:38.812909 (Thread-1): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_id".
2022-02-07 07:59:38.813012 (Thread-1): Opening a new connection, currently in state closed
2022-02-07 07:59:38.813108 (Thread-1): Compiling test.data_eng_challenge.not_null_nhl_players_id
2022-02-07 07:59:38.836930 (Thread-2): SQL status: SELECT 1 in 0.03 seconds
2022-02-07 07:59:38.837279 (Thread-2): finished collecting timing info
2022-02-07 07:59:38.837618 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: ROLLBACK
2022-02-07 07:59:38.838776 (Thread-3): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_goals"
2022-02-07 07:59:38.839150 (Thread-3): finished collecting timing info
2022-02-07 07:59:38.841811 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_goals".
2022-02-07 07:59:38.841903 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_goals: BEGIN
2022-02-07 07:59:38.843005 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_assists: Close
2022-02-07 07:59:38.844616 (Thread-2): 07:59:38 | 2 of 7 PASS not_null_nhl_players_assists............................. [PASS in 0.20s]
2022-02-07 07:59:38.856667 (Thread-2): Finished running node test.data_eng_challenge.not_null_nhl_players_assists
2022-02-07 07:59:38.856926 (Thread-2): Began running node test.data_eng_challenge.not_null_nhl_players_points
2022-02-07 07:59:38.861021 (Thread-2): 07:59:38 | 6 of 7 START test not_null_nhl_players_points........................ [RUN]
2022-02-07 07:59:38.862047 (Thread-3): SQL status: BEGIN in 0.02 seconds
2022-02-07 07:59:38.862184 (Thread-3): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_goals".
2022-02-07 07:59:38.862263 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_goals: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_goals"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where goals is null


2022-02-07 07:59:38.867003 (Thread-2): Acquiring new postgres connection "test.data_eng_challenge.not_null_nhl_players_points".
2022-02-07 07:59:38.867115 (Thread-2): Opening a new connection, currently in state closed
2022-02-07 07:59:38.867210 (Thread-2): Compiling test.data_eng_challenge.not_null_nhl_players_points
2022-02-07 07:59:38.875477 (Thread-2): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_points"
2022-02-07 07:59:38.876004 (Thread-2): finished collecting timing info
2022-02-07 07:59:38.876276 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_points".
2022-02-07 07:59:38.876356 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_points: BEGIN
2022-02-07 07:59:38.893883 (Thread-3): SQL status: SELECT 1 in 0.03 seconds
2022-02-07 07:59:38.894244 (Thread-3): finished collecting timing info
2022-02-07 07:59:38.894521 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_goals: ROLLBACK
2022-02-07 07:59:38.906289 (Thread-1): Writing injected SQL for node "test.data_eng_challenge.not_null_nhl_players_id"
2022-02-07 07:59:38.910986 (Thread-3): On test.data_eng_challenge.not_null_nhl_players_goals: Close
2022-02-07 07:59:38.914806 (Thread-3): 07:59:38 | 4 of 7 PASS not_null_nhl_players_goals............................... [PASS in 0.17s]
2022-02-07 07:59:38.915170 (Thread-3): Finished running node test.data_eng_challenge.not_null_nhl_players_goals
2022-02-07 07:59:38.915308 (Thread-3): Began running node test.data_eng_challenge.unique_nhl_players_id
2022-02-07 07:59:38.915421 (Thread-3): 07:59:38 | 7 of 7 START test unique_nhl_players_id.............................. [RUN]
2022-02-07 07:59:38.915832 (Thread-3): Acquiring new postgres connection "test.data_eng_challenge.unique_nhl_players_id".
2022-02-07 07:59:38.915918 (Thread-3): Opening a new connection, currently in state closed
2022-02-07 07:59:38.916003 (Thread-3): Compiling test.data_eng_challenge.unique_nhl_players_id
2022-02-07 07:59:38.928880 (Thread-3): Writing injected SQL for node "test.data_eng_challenge.unique_nhl_players_id"
2022-02-07 07:59:38.938366 (Thread-1): finished collecting timing info
2022-02-07 07:59:38.941092 (Thread-1): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_id".
2022-02-07 07:59:38.941183 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: BEGIN
2022-02-07 07:59:38.940769 (Thread-2): SQL status: BEGIN in 0.06 seconds
2022-02-07 07:59:38.942246 (Thread-2): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_points".
2022-02-07 07:59:38.942332 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_points: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_points"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where points is null


2022-02-07 07:59:38.961354 (Thread-2): SQL status: SELECT 1 in 0.02 seconds
2022-02-07 07:59:38.961730 (Thread-2): finished collecting timing info
2022-02-07 07:59:38.962049 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_points: ROLLBACK
2022-02-07 07:59:38.964604 (Thread-2): On test.data_eng_challenge.not_null_nhl_players_points: Close
2022-02-07 07:59:38.965056 (Thread-2): 07:59:38 | 6 of 7 PASS not_null_nhl_players_points.............................. [PASS in 0.10s]
2022-02-07 07:59:38.970115 (Thread-2): Finished running node test.data_eng_challenge.not_null_nhl_players_points
2022-02-07 07:59:38.972862 (Thread-3): finished collecting timing info
2022-02-07 07:59:38.973215 (Thread-3): Using postgres connection "test.data_eng_challenge.unique_nhl_players_id".
2022-02-07 07:59:38.973298 (Thread-3): On test.data_eng_challenge.unique_nhl_players_id: BEGIN
2022-02-07 07:59:38.976208 (Thread-1): SQL status: BEGIN in 0.03 seconds
2022-02-07 07:59:38.976317 (Thread-1): Using postgres connection "test.data_eng_challenge.not_null_nhl_players_id".
2022-02-07 07:59:38.976390 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.not_null_nhl_players_id"} */




select count(*) as validation_errors
from "postgres"."public"."nhl_players"
where id is null


2022-02-07 07:59:38.980713 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-02-07 07:59:38.980982 (Thread-1): finished collecting timing info
2022-02-07 07:59:38.981278 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: ROLLBACK
2022-02-07 07:59:38.986354 (Thread-1): On test.data_eng_challenge.not_null_nhl_players_id: Close
2022-02-07 07:59:38.986874 (Thread-1): 07:59:38 | 5 of 7 PASS not_null_nhl_players_id.................................. [PASS in 0.17s]
2022-02-07 07:59:38.987240 (Thread-1): Finished running node test.data_eng_challenge.not_null_nhl_players_id
2022-02-07 07:59:38.991808 (Thread-3): SQL status: BEGIN in 0.02 seconds
2022-02-07 07:59:38.991958 (Thread-3): Using postgres connection "test.data_eng_challenge.unique_nhl_players_id".
2022-02-07 07:59:38.992205 (Thread-3): On test.data_eng_challenge.unique_nhl_players_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "default", "target_name": "challenge", "node_id": "test.data_eng_challenge.unique_nhl_players_id"} */




select count(*) as validation_errors
from (

    select
        id

    from "postgres"."public"."nhl_players"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2022-02-07 07:59:39.002859 (Thread-3): SQL status: SELECT 1 in 0.01 seconds
2022-02-07 07:59:39.003196 (Thread-3): finished collecting timing info
2022-02-07 07:59:39.003488 (Thread-3): On test.data_eng_challenge.unique_nhl_players_id: ROLLBACK
2022-02-07 07:59:39.003696 (Thread-3): On test.data_eng_challenge.unique_nhl_players_id: Close
2022-02-07 07:59:39.004136 (Thread-3): 07:59:39 | 7 of 7 PASS unique_nhl_players_id.................................... [PASS in 0.09s]
2022-02-07 07:59:39.005667 (Thread-3): Finished running node test.data_eng_challenge.unique_nhl_players_id
2022-02-07 07:59:39.006828 (MainThread): Acquiring new postgres connection "master".
2022-02-07 07:59:39.006926 (MainThread): Opening a new connection, currently in state closed
2022-02-07 07:59:39.007162 (MainThread): 07:59:39 | 
2022-02-07 07:59:39.008995 (MainThread): 07:59:39 | Finished running 7 tests in 0.56s.
2022-02-07 07:59:39.011960 (MainThread): Connection 'master' was properly closed.
2022-02-07 07:59:39.012060 (MainThread): Connection 'test.data_eng_challenge.not_null_nhl_players_id' was properly closed.
2022-02-07 07:59:39.012127 (MainThread): Connection 'test.data_eng_challenge.unique_nhl_players_id' was properly closed.
2022-02-07 07:59:39.012217 (MainThread): Connection 'test.data_eng_challenge.not_null_nhl_players_points' was properly closed.
2022-02-07 07:59:39.084570 (MainThread): 
2022-02-07 07:59:39.085158 (MainThread): Completed successfully
2022-02-07 07:59:39.086543 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2022-02-07 07:59:39.086853 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4100c9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4100c94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4100c9700>]}
2022-02-07 07:59:39.087067 (MainThread): Flushing usage events
